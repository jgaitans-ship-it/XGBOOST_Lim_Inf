<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julio César Gaitán Silva">

<title>XGBOOST_Lim_Inf</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="XGBOOST_Lim_Inf_files/libs/clipboard/clipboard.min.js"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/popper.min.js"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/anchor.min.js"></script>
<link href="XGBOOST_Lim_Inf_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="XGBOOST_Lim_Inf_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="XGBOOST_Lim_Inf_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="XGBOOST_Lim_Inf_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="XGBOOST_Lim_Inf_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">XGBOOST_Lim_Inf</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julio César Gaitán Silva </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="cargar-librerías" class="level1">
<h1>1. Cargar librerías</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: lattice</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.8.80</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)       <span class="co"># Para trabajar con datos raster</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: sp</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)           <span class="co"># Para manipulación de datos espaciales</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.1, GDAL 3.11.4, PROJ 9.7.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)     <span class="co"># Para manejar archivos Excel</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Conjunto de paquetes para manipulación de datos\library(DataExplorer) # Exploración de datos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ lubridate 1.9.4     ✔ tibble    3.3.0
✔ purrr     1.2.0     ✔ tidyr     1.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract() masks raster::extract(), terra::extract()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ purrr::lift()    masks caret::lift()
✖ dplyr::select()  masks raster::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)        <span class="co"># Visualización de mapas\library(ithir)       # Modelado de suelos</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aqp)         <span class="co"># Análisis de perfiles de suelo</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is aqp 2.2-1

Adjuntando el paquete: 'aqp'

The following objects are masked from 'package:dplyr':

    combine, slice

The following objects are masked from 'package:raster':

    coordinates, metadata, metadata&lt;-, proj4string

The following objects are masked from 'package:sp':

    coordinates, coordinates&lt;-, proj4string, proj4string&lt;-</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'kernlab'

The following object is masked from 'package:purrr':

    cross

The following objects are masked from 'package:raster':

    buffer, rotated

The following objects are masked from 'package:terra':

    buffer, size

The following object is masked from 'package:ggplot2':

    alpha</code></pre>
</div>
</div>
</section>
<section id="carpeta-donde-están-todos-los-rásters-ya-procesados" class="level1">
<h1>2. Carpeta donde están TODOS los rásters ya procesados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">"D:/Meta_vichada/aligned/"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>rasters_sel <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Aspect.tif",</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CI.tif"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"C.O.tif"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Convergence_Index.tif",</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Hillshade.tif",</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HH.tif"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HV.tif"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LS_Factor.tif"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MCARI.tif"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NDTI.tif"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Plan_Curvature.tif",</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Precipitación.tif",</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Profile_Curvature.tif",</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relative_Slope_Position.tif"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suelos_.tif"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Media_.tif",</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Topographic_Wetness_Index.tif"</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Total_Catchment_Area.tif",</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Valley_Depth.tif"</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"GNDVI.tif",</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"BSI.tif",</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Base_Level.tif",</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Distance.tif",</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"DEM.tif",</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"EVI.tif",</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NBR.tif",</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDVI.tif",</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDWI.tif",</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"SAVI.tif",</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Slope.tif"</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Maxima_.tif",</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Minima_.tif",</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="construir-rutas-completas-solo-de-los-seleccionados" class="level1">
<h1>3. Construir rutas completas SOLO de los seleccionados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ruta, rasters_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificar-cuáles-existen-control-de-errores" class="level1">
<h1>4. Verificar cuáles existen (control de errores)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> files_sel[<span class="fu">file.exists</span>(files_sel)]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Si alguno falta, aquí lo ves</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">basename</span>(files_sel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CI.tif"                        "C.O.tif"                      
 [3] "HH.tif"                        "HV.tif"                       
 [5] "LS_Factor.tif"                 "MCARI.tif"                    
 [7] "NDTI.tif"                      "Relative_Slope_Position.tif"  
 [9] "Suelos_.tif"                   "Topographic_Wetness_Index.tif"
[11] "Valley_Depth.tif"             </code></pre>
</div>
</div>
</section>
<section id="cargar-como-spatraster" class="level1">
<h1>5. Cargar como SpatRaster</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>raster <span class="ot">&lt;-</span> <span class="fu">rast</span>(files_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificación-rápida" class="level1">
<h1>6. Verificación rápida</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareGeom</span>(raster, raster[[<span class="dv">1</span>]], <span class="at">stopOnError =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="visualización" class="level1">
<h1>7. Visualización</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="obtener-coordenadas-únicas" class="level1">
<h1>8. Obtener coordenadas únicas</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>SCHS <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/SCHS.xlsx"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Coor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Perfil_COD1=</span>SCHS<span class="sc">$</span>Perfil_COD1,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Latitud =</span> SCHS<span class="sc">$</span>Latitud,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Longitud =</span> SCHS<span class="sc">$</span>Longitud,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Lim_inf =</span> SCHS<span class="sc">$</span>lim_inf )</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Coor)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Coor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   223 obs. of  4 variables:
 $ Perfil_COD1: chr  "AR-011" "AR-021" "AR-026" "AR-043" ...
 $ Latitud    : num  3.36 3.5 3.46 3.38 4.5 ...
 $ Longitud   : num  -73.7 -74 -73.9 -73.7 -71.3 ...
 $ Lim_inf    : num  40.2 43.7 36.9 54.4 87.4 ...</code></pre>
</div>
</div>
</section>
<section id="convertir-a-formato-espacial-sf" class="level1">
<h1>9. Convertir a formato espacial (sf)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_final_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="at">x =</span> Coor,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitud"</span>, <span class="st">"Latitud"</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_final_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizar-los-puntos-sobre-el-modelo-de-elevación-dem" class="level1">
<h1>10. Visualizar los puntos sobre el modelo de elevación (DEM)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster<span class="sc">$</span>Topographic_Wetness_Index)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(data_final_sf), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualización-con-tmap" class="level1">
<h1>11. Visualización con tmap</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(raster<span class="sc">$</span>Topographic_Wetness_Index) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#CCCCCC"</span>, <span class="st">"#999999"</span>, <span class="st">"#666666"</span>, <span class="st">"#333333"</span>, <span class="st">"#000000"</span>)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(data_final_sf) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="st">"Lim_sup"</span>, <span class="at">palette =</span> <span class="st">"-RdYlBu"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="st">"Mapa Lim_Sup cm"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_tm_raster()`: migrate the argument(s) related to the scale of the
visual variable `col` namely 'palette' (rename to 'values') to col.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_tm_dots()`: migrate the argument(s) related to the scale of the
visual variable `fill` namely 'palette' (rename to 'values') to fill.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_layout()`: use `tm_title()` instead of `tm_layout(title = )`
! `tm_scale_bar()` is deprecated. Please use `tm_scalebar()` instead.
SpatRaster object downsampled to 2505 by 3993 cells.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extraer-valores-raster-en-los-puntos-espaciales" class="level1">
<h1>12. Extraer valores raster en los puntos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>extraccion <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(raster, <span class="fu">vect</span>(data_final_sf))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_sf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_final_sf, extraccion[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span> (data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="modelamiento--" class="level1">
<h1>Modelamiento —————————————————————-</h1>
</section>
<section id="resumen-de-los-datos-espaciales" class="level1">
<h1>13. Resumen de los datos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Perfil_COD1           Lim_inf             CI              C.O       
 Length:223         Min.   : 14.00   Min.   :0.1548   Min.   :16.10  
 Class :character   1st Qu.: 37.68   1st Qu.:0.5949   1st Qu.:22.54  
 Mode  :character   Median : 49.76   Median :0.7866   Median :25.26  
                    Mean   : 59.00   Mean   :0.9245   Mean   :26.70  
                    3rd Qu.: 74.80   3rd Qu.:1.1661   3rd Qu.:31.83  
                    Max.   :152.89   Max.   :2.3920   Max.   :70.25  
       HH                HV            LS_Factor             MCARI         
 Min.   :-21.077   Min.   :-31.215   Min.   : 0.000109   Min.   :0.008303  
 1st Qu.:-14.234   1st Qu.:-23.681   1st Qu.: 0.182144   1st Qu.:0.048960  
 Median :-11.418   Median :-19.620   Median : 0.398931   Median :0.062091  
 Mean   :-11.593   Mean   :-19.559   Mean   : 1.367394   Mean   :0.063377  
 3rd Qu.: -8.400   3rd Qu.:-15.394   3rd Qu.: 0.994487   3rd Qu.:0.077803  
 Max.   : -2.833   Max.   : -8.273   Max.   :42.507114   Max.   :0.133466  
      NDTI         Relative_Slope_Position    Suelos_     
 Min.   :0.02205   Min.   :0.000000        Min.   : 0.00  
 1st Qu.:0.16573   1st Qu.:0.001624        1st Qu.: 4.00  
 Median :0.18370   Median :0.008076        Median :17.00  
 Mean   :0.18000   Mean   :0.037125        Mean   :22.99  
 3rd Qu.:0.20172   3rd Qu.:0.033358        3rd Qu.:39.50  
 Max.   :0.23763   Max.   :0.781887        Max.   :57.00  
 Topographic_Wetness_Index  Valley_Depth              geometry  
 Min.   : 5.026            Min.   :  4.941   POINT        :223  
 1st Qu.: 7.413            1st Qu.:121.849   epsg:4326    :  0  
 Median : 8.399            Median :195.087   +proj=long...:  0  
 Mean   : 9.777            Mean   :237.090                      
 3rd Qu.:10.900            3rd Qu.:303.693                      
 Max.   :25.343            Max.   :770.234                      </code></pre>
</div>
</div>
</section>
<section id="convertir-a-dataframe-para-modelado-no-se-tiene-en-cuenta-la-columna-id" class="level1">
<h1>14. Convertir a dataframe para modelado, no se tiene en cuenta la columna ID</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(data_sf)[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_sf_df)<span class="co">#</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Lim_inf             CI              C.O              HH         
 Min.   : 14.00   Min.   :0.1548   Min.   :16.10   Min.   :-21.077  
 1st Qu.: 37.68   1st Qu.:0.5949   1st Qu.:22.54   1st Qu.:-14.234  
 Median : 49.76   Median :0.7866   Median :25.26   Median :-11.418  
 Mean   : 59.00   Mean   :0.9245   Mean   :26.70   Mean   :-11.593  
 3rd Qu.: 74.80   3rd Qu.:1.1661   3rd Qu.:31.83   3rd Qu.: -8.400  
 Max.   :152.89   Max.   :2.3920   Max.   :70.25   Max.   : -2.833  
       HV            LS_Factor             MCARI               NDTI        
 Min.   :-31.215   Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.:-23.681   1st Qu.: 0.182144   1st Qu.:0.048960   1st Qu.:0.16573  
 Median :-19.620   Median : 0.398931   Median :0.062091   Median :0.18370  
 Mean   :-19.559   Mean   : 1.367394   Mean   :0.063377   Mean   :0.18000  
 3rd Qu.:-15.394   3rd Qu.: 0.994487   3rd Qu.:0.077803   3rd Qu.:0.20172  
 Max.   : -8.273   Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001624        1st Qu.: 4.00   1st Qu.: 7.413           
 Median :0.008076        Median :17.00   Median : 8.399           
 Mean   :0.037125        Mean   :22.99   Mean   : 9.777           
 3rd Qu.:0.033358        3rd Qu.:39.50   3rd Qu.:10.900           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth    
 Min.   :  4.941  
 1st Qu.:121.849  
 Median :195.087  
 Mean   :237.090  
 3rd Qu.:303.693  
 Max.   :770.234  </code></pre>
</div>
</div>
</section>
<section id="mejor-semilla-particion-de-datos-y-mejor-modelo" class="level1">
<h1>15.Mejor Semilla particion de datos y mejor modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data_sf_df<span class="sc">$</span>Lim_inf</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> data_sf_df[, <span class="sc">!</span>(<span class="fu">names</span>(data_sf_df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Lim_inf"</span>))]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>resultados_Lim_Inf_XGB <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="fu">integer</span>(),</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_test =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_test =</span> <span class="fu">numeric</span>()</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>best_rmse  <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>best_seed  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>) {</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(s)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(y, <span class="at">p =</span> <span class="fl">0.70</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  X_train <span class="ot">&lt;-</span> X[index, ]</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  X_test  <span class="ot">&lt;-</span> X[<span class="sc">-</span>index, ]</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  y_train <span class="ot">&lt;-</span> y[index]</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  y_test  <span class="ot">&lt;-</span> y[<span class="sc">-</span>index]</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  dtrain <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(X_train, <span class="at">label =</span> y_train)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  dtest  <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(X_test,  <span class="at">label =</span> y_test)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">objective =</span> <span class="st">"reg:squarederror"</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta =</span> <span class="fl">0.05</span>,</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_depth =</span> <span class="dv">3</span>,</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subsample =</span> <span class="fl">0.8</span>,</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">colsample_bytree =</span> <span class="fl">0.8</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> params,</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dtrain,</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrounds =</span> <span class="dv">100</span>,</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="dv">0</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ===== MÉTRICAS TRAIN</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  pred_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, dtrain)</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>  RMSE_train <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_train, y_train)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  R2_train   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred_train, y_train)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ===== MÉTRICAS </span><span class="al">TEST</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, dtest)</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  RMSE_test <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_test, y_test)</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  R2_test   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred_test, y_test)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  resultados_Lim_Inf_XGB <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    resultados_Lim_Inf_XGB,</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> s,</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_train =</span> RMSE_train,</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_train =</span> R2_train,</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_test =</span> RMSE_test,</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_test =</span> R2_test</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (RMSE_test <span class="sc">&lt;</span> best_rmse) {</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>    best_rmse  <span class="ot">&lt;-</span> RMSE_test</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> modelo</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>    best_seed  <span class="ot">&lt;-</span> s</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>best_seed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 125</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>best_rmse</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.47802</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>best_model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>##### xgb.Booster
call:
  xgb.train(params = params, data = dtrain, nrounds = 100, verbose = 0)
# of features: 11 
# of rounds:  100 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados_Lim_Inf_XGB)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    seed RMSE_train  R2_train RMSE_test      R2_test
1      1   13.55844 0.8801413  25.23001 0.2301023937
2      2   12.31583 0.8816187  32.55776 0.1195153767
3      3   12.64486 0.8765094  32.14547 0.0824897784
4      4   12.85917 0.8925411  26.65169 0.1832011343
5      5   12.42248 0.8745357  32.43110 0.2420290137
6      6   12.78103 0.8892336  29.22664 0.1115109986
7      7   13.05648 0.8790686  28.29471 0.1207150492
8      8   11.96541 0.8822568  31.63156 0.1380971625
9      9   13.41217 0.8687286  31.28771 0.1001737534
10    10   12.07096 0.8913215  32.44389 0.1239243439
11    11   12.46141 0.8975252  30.14430 0.1635653595
12    12   13.41310 0.8945868  22.11629 0.3207044505
13    13   11.67348 0.9076666  30.70244 0.0351281752
14    14   12.14243 0.8870131  32.64886 0.0644277834
15    15   13.36229 0.8803762  25.74072 0.2238532715
16    16   12.81461 0.8813720  30.75512 0.1346123169
17    17   12.99797 0.8744101  28.78581 0.2066724438
18    18   12.20708 0.9002711  30.89563 0.0121975180
19    19   12.89950 0.8794878  30.28797 0.1516489054
20    20   13.63200 0.8762458  27.13938 0.0934549163
21    21   12.30701 0.8811592  31.57452 0.1291135951
22    22   12.46621 0.9021322  29.53119 0.0897723826
23    23   12.31114 0.8845880  32.34683 0.0935023252
24    24   12.36578 0.8904522  29.92026 0.0998225095
25    25   13.87901 0.8876361  26.02610 0.0423636564
26    26   12.27734 0.8899805  31.91600 0.0142784869
27    27   13.19194 0.8948159  24.16465 0.1979784066
28    28   13.65015 0.8530082  30.12299 0.1370184730
29    29   12.04257 0.8972088  30.42289 0.1033619474
30    30   13.69578 0.8730799  26.30988 0.2304153800
31    31   12.43374 0.8747648  32.32859 0.1164378259
32    32   12.22717 0.8955898  29.06853 0.1591031570
33    33   13.02490 0.8861721  27.82083 0.1832727226
34    34   12.90535 0.8768429  29.17191 0.1312631430
35    35   11.99459 0.8913765  30.83857 0.0389244428
36    36   12.36020 0.8828547  31.42167 0.0484599366
37    37   13.13113 0.8803948  28.70357 0.1594336663
38    38   12.62670 0.8958562  28.00009 0.2604189928
39    39   12.17459 0.8829885  31.49307 0.0727417953
40    40   13.47516 0.8942832  24.22499 0.1848874641
41    41   11.68088 0.8952886  32.29955 0.0209615316
42    42   12.45375 0.9119754  29.61098 0.1708575298
43    43   12.75831 0.8984391  27.61492 0.1750175730
44    44   12.47082 0.8920441  29.55713 0.1084076522
45    45   11.35049 0.8870085  36.32378 0.0220381231
46    46   13.46781 0.8942068  25.39324 0.2607243712
47    47   12.11703 0.8974203  29.87998 0.0529651545
48    48   12.31966 0.8954192  29.72812 0.1636070181
49    49   12.53010 0.8918512  28.72560 0.1914949887
50    50   13.45771 0.8888820  26.04808 0.2197714482
51    51   12.46003 0.8892069  29.41147 0.1300847037
52    52   11.65294 0.8938354  33.10527 0.0152441913
53    53   14.16139 0.8754131  23.25772 0.3542857486
54    54   11.85860 0.8851024  31.83108 0.2182634400
55    55   12.56335 0.8894959  27.86010 0.1496512332
56    56   13.62614 0.8880216  25.07704 0.2144442826
57    57   12.05390 0.8972689  30.09917 0.1903537662
58    58   12.12723 0.8815410  33.47013 0.1076455529
59    59   12.21185 0.8869748  31.93747 0.0894112251
60    60   12.84270 0.8948603  27.11021 0.0969873586
61    61   12.78170 0.8875706  28.66730 0.1337244878
62    62   12.74017 0.9025936  27.97409 0.1721958824
63    63   12.55305 0.8862901  30.21468 0.0989601957
64    64   13.12186 0.8882895  28.96149 0.1041284105
65    65   12.83936 0.8810701  29.80205 0.0999685799
66    66   12.88973 0.8897138  28.32303 0.1239373695
67    67   11.52061 0.9001342  32.36899 0.0333815836
68    68   12.61953 0.8936054  27.55498 0.1245860722
69    69   12.31817 0.8946525  29.61632 0.0762467231
70    70   13.17092 0.8781939  29.79254 0.0995765295
71    71   12.36283 0.8883352  31.31762 0.1157417385
72    72   12.52451 0.8980154  26.96871 0.2302199517
73    73   12.33848 0.8916201  28.88438 0.2403181606
74    74   12.54703 0.8931441  27.09859 0.2342293715
75    75   12.40124 0.8938555  30.02097 0.0586220095
76    76   12.04659 0.9030283  29.88339 0.1492947642
77    77   12.83176 0.8940133  27.69243 0.1379924709
78    78   11.62867 0.8947467  33.88951 0.0240718706
79    79   13.60545 0.8842992  24.10920 0.2453739880
80    80   13.01330 0.8838562  28.27492 0.0821426985
81    81   12.65316 0.8850629  30.57342 0.0647613180
82    82   12.88236 0.8884755  30.38427 0.0896402078
83    83   11.79197 0.8889991  34.51403 0.0217560679
84    84   12.91661 0.8867154  27.37769 0.1394846609
85    85   13.07405 0.8841771  26.80358 0.2052752023
86    86   13.47111 0.8796795  27.33739 0.1185717527
87    87   13.03764 0.8852583  26.37016 0.1720315170
88    88   12.49612 0.8907988  31.15270 0.0994516892
89    89   11.87774 0.8905500  32.09142 0.0975924858
90    90   12.75084 0.8846159  30.20915 0.0807344709
91    91   12.56342 0.8927724  30.78044 0.0483740036
92    92   12.43378 0.8911641  28.53573 0.1421833692
93    93   13.01085 0.8891857  27.51560 0.2774660029
94    94   12.84316 0.8953844  26.33148 0.0939290738
95    95   12.31909 0.8913602  28.95851 0.1994231014
96    96   13.45487 0.8893414  25.32417 0.2065078626
97    97   13.06690 0.8837079  27.00660 0.1145591122
98    98   12.26372 0.8945843  32.27336 0.0515801638
99    99   12.66914 0.8933850  27.41169 0.2169526738
100  100   13.51832 0.9020560  24.53136 0.3529472826
101  101   13.18364 0.8917097  27.32660 0.1193262120
102  102   12.92414 0.8884249  28.30037 0.0971707148
103  103   12.60814 0.8908410  29.50529 0.1350593066
104  104   11.57786 0.9144288  30.70997 0.0695227593
105  105   12.95695 0.8801749  29.76610 0.0931710756
106  106   13.27061 0.8878896  26.24679 0.1648131628
107  107   11.14598 0.9119905  32.43224 0.1316617866
108  108   13.19069 0.8920778  26.76726 0.1233987443
109  109   13.12523 0.8921867  26.85762 0.0594089706
110  110   12.55504 0.9070677  26.09221 0.2151592371
111  111   11.75942 0.9102124  25.93794 0.1556447941
112  112   13.41937 0.8824417  28.34286 0.1115956369
113  113   13.24428 0.8968760  27.49787 0.1829337722
114  114   12.85130 0.8906818  30.35670 0.0413527868
115  115   13.24775 0.8797948  29.40955 0.0833607354
116  116   12.35138 0.8906410  29.56487 0.1028664526
117  117   13.16780 0.8880643  28.92442 0.1424639216
118  118   12.90674 0.8956322  26.32240 0.2094971297
119  119   12.65504 0.8876527  28.89110 0.1147861963
120  120   13.67427 0.8810315  26.44155 0.1581698024
121  121   13.10359 0.8844287  28.19506 0.2000026082
122  122   12.74846 0.8898820  29.84200 0.2428983816
123  123   11.79657 0.8988045  33.01139 0.1176685048
124  124   12.97889 0.8880954  28.69819 0.1243488719
125  125   14.09008 0.8927849  21.47802 0.3146281884
126  126   11.94746 0.8957143  32.36635 0.1310515818
127  127   13.49364 0.8899443  25.16073 0.2925786179
128  128   11.30133 0.9033536  32.37574 0.0584722942
129  129   11.86275 0.8947130  29.94201 0.1787758128
130  130   13.17168 0.8696784  30.87526 0.1149692387
131  131   12.45143 0.8998453  28.06193 0.1288169027
132  132   12.45344 0.8940588  29.92855 0.0752009812
133  133   12.66333 0.8845553  31.12951 0.0848470489
134  134   12.33798 0.8926299  29.85290 0.0895289551
135  135   12.33283 0.9015522  28.08044 0.1096237098
136  136   13.08478 0.8854858  28.51136 0.2234679517
137  137   12.09436 0.9072407  28.98959 0.1044616598
138  138   12.20552 0.8955218  31.11214 0.1263054314
139  139   12.24648 0.8846943  30.24031 0.1273768214
140  140   11.98953 0.8967580  30.91379 0.0570917532
141  141   12.77375 0.8925724  28.49821 0.1484529381
142  142   12.76686 0.8859438  29.37356 0.1466803001
143  143   13.55732 0.8864665  24.85350 0.1215197959
144  144   11.27704 0.9043929  33.96586 0.0648744795
145  145   12.71434 0.8890899  27.53360 0.1691097880
146  146   13.26551 0.8809431  29.38273 0.0868241948
147  147   12.82708 0.8782150  30.30397 0.1247769810
148  148   12.02595 0.8859040  30.99707 0.1076933591
149  149   12.09688 0.8903461  32.33639 0.1263328342
150  150   11.35593 0.8966484  34.46989 0.1126007021
151  151   13.18631 0.8739037  29.43144 0.1615060149
152  152   13.22498 0.8803528  26.25301 0.2874031205
153  153   13.57479 0.8820764  24.98386 0.2303400266
154  154   12.33287 0.8940119  29.86308 0.0108567931
155  155   13.23493 0.8870092  27.21590 0.1944905416
156  156   12.06228 0.8891032  32.11047 0.0619680376
157  157   12.68050 0.8993058  25.92142 0.2875550586
158  158   11.58635 0.8920464  33.21571 0.1093368435
159  159   13.09644 0.8741268  28.91913 0.1473695351
160  160   13.48005 0.8757567  28.45114 0.1218609511
161  161   12.96461 0.8979982  26.47151 0.2714967888
162  162   12.43293 0.8928933  27.90241 0.0976192601
163  163   12.50973 0.8823812  32.73279 0.0925548407
164  164   12.16748 0.9015330  27.30808 0.1861993145
165  165   13.29097 0.8896866  25.72485 0.1647654208
166  166   12.52071 0.8993326  29.14550 0.2085026627
167  167   13.38585 0.8880698  26.92725 0.0514936227
168  168   11.82085 0.9020331  31.85168 0.0957559474
169  169   13.12946 0.8899120  27.26592 0.0894416792
170  170   12.19028 0.9016245  30.99665 0.1229209875
171  171   11.26095 0.8997402  34.29249 0.0478308181
172  172   13.93146 0.8674730  26.35603 0.1865496267
173  173   12.67241 0.8907841  33.77331 0.0399139787
174  174   12.89287 0.8884116  28.08192 0.0760936171
175  175   12.36436 0.9060863  26.19804 0.1705601901
176  176   12.37799 0.9081521  27.21832 0.1802180414
177  177   12.18939 0.8886629  29.88415 0.1959876954
178  178   13.97577 0.8847470  23.46725 0.1082740729
179  179   12.30220 0.8919623  29.19059 0.1581679034
180  180   12.06151 0.8899502  31.16211 0.1159260760
181  181   13.38362 0.8955733  24.68581 0.2899421528
182  182   13.71573 0.8659013  29.11828 0.1365063863
183  183   11.80295 0.9053616  29.67640 0.0927905997
184  184   12.29470 0.8947406  28.88859 0.1568021920
185  185   12.73267 0.8853412  29.45937 0.1069421307
186  186   12.64566 0.8941091  29.92059 0.0472079352
187  187   12.43713 0.8709351  33.28765 0.1244479063
188  188   12.83158 0.8951467  26.49195 0.1872079265
189  189   12.54002 0.8745921  32.71871 0.0809953591
190  190   11.59018 0.9078344  31.36385 0.0795217758
191  191   13.05566 0.8967866  26.62445 0.1618381252
192  192   12.44398 0.8733459  33.05974 0.1476396426
193  193   13.82642 0.8734773  25.53043 0.2257185961
194  194   12.53027 0.8943264  29.04773 0.0825104356
195  195   13.02716 0.8961669  28.04549 0.1328901440
196  196   13.22633 0.8814067  25.73190 0.2620346853
197  197   12.67417 0.9061936  24.91713 0.1442220880
198  198   11.95058 0.8959627  29.38626 0.1861913023
199  199   11.91946 0.9050435  30.18043 0.1151431862
200  200   13.37110 0.8905321  25.88836 0.1329336304
201  201   13.76171 0.8965886  21.68209 0.4096281948
202  202   12.06326 0.9043139  29.24307 0.2062452391
203  203   12.99714 0.8938616  26.17869 0.2221740737
204  204   11.94452 0.8800829  33.32094 0.0971487980
205  205   12.59394 0.8896993  28.71256 0.0609668879
206  206   13.24143 0.9044445  25.74408 0.1843723944
207  207   12.50260 0.8784310  33.78556 0.0383637728
208  208   11.72966 0.8896207  33.47369 0.0230376897
209  209   12.52622 0.8854165  31.75963 0.1011344296
210  210   12.85021 0.8957399  29.28071 0.1732187541
211  211   13.95829 0.8536856  27.16487 0.2812792239
212  212   11.91473 0.9012798  30.81126 0.0893014226
213  213   12.78105 0.8778876  31.46644 0.0823150514
214  214   12.47973 0.8983826  30.45468 0.0648444056
215  215   11.62794 0.8929680  33.58227 0.0799019303
216  216   11.22712 0.9001840  33.91180 0.0765665765
217  217   13.14937 0.8816849  28.31756 0.1260470238
218  218   13.11139 0.8989033  26.11915 0.2399270185
219  219   12.74167 0.8835057  30.79738 0.0802881432
220  220   13.43473 0.8631376  29.30326 0.1723308204
221  221   13.20259 0.8966392  27.03946 0.2217191619
222  222   12.00773 0.8959729  30.07172 0.1160064251
223  223   12.25282 0.8963035  30.04242 0.1660951750
224  224   12.62132 0.8801572  30.33195 0.1105638434
225  225   12.78339 0.9027869  24.66117 0.1480267074
226  226   12.96677 0.8892621  31.92575 0.0763457374
227  227   11.76653 0.8887884  32.00446 0.0707680719
228  228   12.52358 0.9016262  27.61758 0.0345471004
229  229   12.82538 0.8999657  26.30058 0.2414186312
230  230   12.05259 0.9120330  31.30656 0.0414099499
231  231   13.14881 0.8836933  28.54493 0.1396508071
232  232   12.82699 0.8885864  27.19861 0.0807087868
233  233   12.78623 0.8924462  28.84239 0.1226511125
234  234   12.81396 0.8798760  30.94850 0.1429853381
235  235   12.07538 0.9000186  31.49318 0.2075488073
236  236   13.17483 0.8827855  28.90390 0.0998314160
237  237   13.17929 0.8928221  28.47893 0.1889984219
238  238   11.87333 0.8993271  29.79760 0.1413817642
239  239   12.74863 0.8952099  27.37699 0.0925412306
240  240   13.02647 0.8803046  30.49740 0.1372306452
241  241   12.34133 0.9110983  28.05025 0.2088216542
242  242   11.18613 0.8951192  34.55528 0.0991204407
243  243   13.53745 0.8767786  27.14337 0.2612644536
244  244   11.85484 0.8964420  31.63041 0.0688933766
245  245   12.13877 0.8990990  30.94070 0.0998885008
246  246   14.06847 0.8760135  22.71474 0.3552292458
247  247   11.85669 0.8936234  32.88228 0.0791218810
248  248   13.26470 0.8781449  28.31071 0.1116233451
249  249   12.94171 0.8928447  27.62250 0.1516753840
250  250   13.03646 0.9043280  25.34845 0.2489375092
251  251   11.54797 0.9078509  31.29054 0.0545358493
252  252   12.56209 0.8993163  29.09607 0.1102323495
253  253   12.31362 0.9061942  28.40382 0.1485124798
254  254   11.60073 0.8951484  34.35563 0.0560969288
255  255   12.51664 0.9006100  27.16006 0.2015349363
256  256   11.95110 0.9002740  29.35215 0.1034625127
257  257   13.07951 0.8730814  30.26545 0.2102338781
258  258   12.21241 0.8831376  30.55830 0.1001359578
259  259   12.29585 0.8893501  31.91158 0.1163220028
260  260   12.10995 0.9094002  27.75490 0.0611053704
261  261   12.73530 0.8985830  27.98805 0.0810438479
262  262   12.79142 0.8895911  28.32441 0.1493304883
263  263   12.04876 0.9038250  30.56752 0.0405461230
264  264   11.27854 0.9107053  30.86435 0.0518118114
265  265   12.67892 0.8954480  27.66954 0.1441495934
266  266   13.15696 0.8933731  25.20573 0.1564911567
267  267   12.60946 0.8923995  29.16639 0.0917992951
268  268   13.21685 0.8802981  29.29073 0.1069184733
269  269   13.97117 0.8668165  26.01532 0.1945324892
270  270   12.74604 0.8815643  30.37528 0.1288521839
271  271   12.99783 0.8893657  27.02160 0.1370177447
272  272   12.93785 0.8844094  26.89886 0.2643257140
273  273   11.96580 0.8853742  33.94584 0.0709197530
274  274   12.06513 0.8891831  32.38014 0.0362367835
275  275   13.02791 0.8884894  27.14032 0.1051371416
276  276   12.16944 0.9054680  28.93456 0.0681419235
277  277   11.75934 0.8906558  32.11841 0.0688911260
278  278   13.45198 0.8959409  22.85039 0.1378941302
279  279   12.64100 0.8816639  28.81161 0.1294327241
280  280   13.97932 0.8979029  22.51841 0.2496702706
281  281   12.64023 0.8764728  30.35038 0.1855791511
282  282   13.03633 0.8851266  27.77480 0.1394387799
283  283   12.36180 0.8871559  31.25131 0.1861933115
284  284   13.07418 0.8805653  28.49866 0.0775682101
285  285   12.07191 0.8932203  31.85461 0.0855476638
286  286   12.36638 0.8831808  32.03507 0.1202120774
287  287   12.56447 0.8901529  27.80810 0.1499541883
288  288   12.25382 0.8947775  32.15367 0.0376036930
289  289   13.67688 0.8860306  24.85998 0.2923049922
290  290   12.58635 0.8967990  31.41970 0.0689255396
291  291   11.31711 0.9037196  33.01045 0.0750476279
292  292   11.91822 0.9062894  30.00139 0.0678188590
293  293   12.70628 0.8886709  29.64634 0.0933914007
294  294   11.72880 0.9009354  30.73247 0.2352908869
295  295   11.99808 0.8889828  31.73324 0.1085088555
296  296   12.93788 0.8920763  26.57271 0.1473325676
297  297   12.34569 0.8917494  30.52905 0.0697459227
298  298   13.46020 0.8913074  27.02766 0.2268030798
299  299   12.91862 0.8899229  29.40873 0.1480103159
300  300   14.44704 0.8505865  28.74651 0.2081407562
301  301   12.19840 0.8795649  33.26403 0.1440272893
302  302   13.28185 0.8799077  25.87534 0.1553964685
303  303   13.23044 0.8700455  29.77815 0.2157676770
304  304   13.18483 0.8902671  26.77965 0.1468593474
305  305   13.13730 0.8928535  26.96746 0.1459892585
306  306   12.77188 0.8950270  27.17367 0.1110302679
307  307   12.28428 0.8839625  29.41359 0.1060786047
308  308   13.01342 0.8829213  28.87834 0.1884725894
309  309   12.21399 0.8957320  31.40412 0.0567742635
310  310   12.72426 0.8917340  28.00354 0.2191028368
311  311   12.77428 0.8931339  28.24156 0.1413327150
312  312   12.46029 0.8942584  28.84547 0.1478089330
313  313   12.28046 0.8883217  32.14534 0.0146603731
314  314   12.70279 0.8855333  28.64520 0.1186132267
315  315   12.41974 0.9039057  27.29794 0.0532079684
316  316   13.11242 0.8904817  25.67989 0.1384983629
317  317   12.56742 0.8875794  30.06504 0.0758092628
318  318   12.53426 0.8986084  30.50342 0.0722829675
319  319   11.71918 0.9008605  31.46264 0.0544263409
320  320   12.15916 0.8985682  27.78954 0.1247686832
321  321   12.90609 0.8853376  26.96790 0.1731814283
322  322   12.53616 0.8833810  31.31269 0.0683807179
323  323   13.20113 0.8867678  26.36817 0.2439558990
324  324   13.76778 0.8655653  27.68545 0.1059621223
325  325   13.28146 0.8843629  28.94474 0.0509214096
326  326   12.52845 0.8948276  29.23151 0.0777797136
327  327   11.59783 0.8918230  34.15853 0.1036854649
328  328   11.84864 0.8989002  31.69247 0.1028054561
329  329   12.80213 0.8839606  28.98288 0.2495009830
330  330   13.06561 0.8808283  26.99375 0.0875088346
331  331   12.44557 0.8990962  30.09698 0.0890942313
332  332   12.26497 0.8871896  32.31148 0.0708483792
333  333   12.98640 0.8916665  29.64351 0.0645010435
334  334   11.90823 0.9020624  31.08508 0.0949165353
335  335   12.58814 0.8806516  30.94208 0.0616261816
336  336   12.58808 0.8914356  27.77424 0.1926740153
337  337   12.50923 0.8861302  32.68514 0.0066138719
338  338   12.67500 0.8900592  28.88735 0.0700514644
339  339   12.38900 0.8917848  28.37323 0.1710386498
340  340   12.50413 0.8917745  30.34974 0.0533249825
341  341   12.70225 0.8761508  31.96284 0.1062818356
342  342   12.30328 0.8927239  29.81817 0.1100550981
343  343   13.60277 0.8833594  25.05802 0.1466938903
344  344   12.65308 0.8905345  29.79875 0.1627943016
345  345   12.05699 0.8852334  33.60085 0.0222703038
346  346   12.12890 0.8903327  33.65159 0.0320901996
347  347   11.54368 0.9045583  32.12744 0.0254021377
348  348   13.11912 0.8870693  27.38401 0.1321728329
349  349   11.68278 0.9002700  32.60767 0.0775362447
350  350   13.27849 0.8831217  29.00514 0.0550169976
351  351   12.17273 0.9044924  29.81545 0.1693670810
352  352   13.11649 0.8796469  27.37866 0.2198220382
353  353   13.47092 0.8862218  24.69697 0.1343199258
354  354   12.64651 0.8929309  27.07724 0.2085856863
355  355   12.36777 0.8914034  31.85629 0.0875383969
356  356   12.25663 0.8923002  29.98927 0.1027498077
357  357   11.63933 0.8935512  33.28934 0.0781917406
358  358   12.78867 0.9029124  25.26793 0.2928837403
359  359   12.46521 0.9018869  27.80905 0.1256146730
360  360   11.99302 0.9007236  32.42446 0.0775695026
361  361   12.67448 0.8892925  29.67664 0.1490487494
362  362   12.84799 0.8876177  27.79706 0.1057889431
363  363   12.93676 0.8809337  31.09551 0.1123019516
364  364   13.08164 0.8843548  27.68423 0.1192517286
365  365   12.54445 0.8731230  32.97714 0.0601523844
366  366   12.20176 0.8932557  32.00328 0.0096330270
367  367   12.42681 0.9003757  27.40222 0.1084608478
368  368   12.68790 0.8859721  30.78460 0.1065895371
369  369   13.13507 0.8992515  23.62802 0.2268494499
370  370   12.21358 0.8993610  28.02586 0.0990504392
371  371   13.34547 0.8871200  28.31025 0.1442766038
372  372   12.42787 0.9010621  29.28398 0.0581484324
373  373   11.06020 0.9055574  35.01364 0.0008486372
374  374   11.98419 0.8893623  31.30092 0.1736248145
375  375   12.10705 0.9029834  29.85154 0.0886479540
376  376   12.50859 0.8993697  28.98911 0.1646619845
377  377   12.62385 0.8821964  30.03433 0.1169262853
378  378   12.96724 0.8948394  28.83451 0.0530928746
379  379   13.18024 0.8598130  33.59757 0.0649611634
380  380   12.03045 0.9100100  27.56515 0.0970947530
381  381   12.54336 0.8960966  28.77634 0.1042119385
382  382   13.23639 0.8857573  24.16762 0.2443214201
383  383   13.11385 0.8872735  29.10402 0.0672139046
384  384   12.74061 0.8909264  27.79402 0.1618161167
385  385   12.44558 0.9008146  30.07701 0.0474938983
386  386   12.42746 0.8980927  30.50205 0.1233478606
387  387   12.84290 0.8994947  28.11629 0.1591619967
388  388   14.02935 0.8645430  28.43354 0.2045083947
389  389   12.52787 0.8905572  31.46324 0.1042862285
390  390   12.84046 0.8942189  27.18951 0.1534283926
391  391   12.06541 0.8912807  32.78163 0.0783470422
392  392   11.95507 0.8788222  33.20036 0.1221787864
393  393   12.80629 0.8885581  32.22358 0.0225955761
394  394   12.64521 0.8895879  28.67061 0.1496224877
395  395   13.16878 0.8896278  27.43644 0.1438322210
396  396   12.24930 0.9132856  25.13377 0.1396018046
397  397   12.75028 0.8973637  27.75186 0.0936118351
398  398   11.92009 0.9015062  29.13802 0.0809882695
399  399   12.68407 0.8920932  28.36407 0.1304139054
400  400   12.63118 0.8937382  30.32200 0.1275586756
401  401   11.99543 0.8932174  32.13866 0.0298874082
402  402   11.62015 0.8909123  34.37022 0.1482541819
403  403   13.04101 0.9003604  24.72670 0.1585422956
404  404   12.63792 0.8935314  30.57528 0.1262096840
405  405   13.58268 0.8794779  24.23187 0.3007428798
406  406   12.21577 0.8928338  28.86405 0.1695512186
407  407   12.80713 0.8945858  26.31133 0.1781254932
408  408   13.18533 0.8924661  25.45195 0.1229443685
409  409   12.15467 0.8860001  31.54082 0.0811992811
410  410   12.90350 0.8893989  29.21819 0.1342338781
411  411   12.97162 0.8867908  27.41392 0.1588264754
412  412   12.34364 0.8983289  30.44952 0.0600358609
413  413   12.18688 0.8901129  31.99134 0.0403192465
414  414   12.77832 0.8951831  27.01150 0.2797501005
415  415   12.29762 0.8874118  32.14185 0.1126610733
416  416   12.80687 0.8857811  29.47828 0.0425517294
417  417   11.46451 0.8951805  34.45690 0.0061672038
418  418   12.88903 0.8824753  28.26017 0.0486754255
419  419   12.28418 0.8960244  29.13018 0.1459567149
420  420   11.37709 0.8804413  37.29429 0.0224362237
421  421   12.77809 0.8927120  27.03855 0.2371185754
422  422   12.81251 0.8857719  29.13072 0.0836967804
423  423   12.79210 0.8721213  30.81382 0.1853136116
424  424   11.72051 0.9061588  30.61845 0.0197304480
425  425   11.98733 0.8871167  31.76736 0.0397697796
426  426   12.08086 0.8978744  30.05175 0.1135879394
427  427   12.85058 0.8789542  29.84663 0.0892480064
428  428   12.36486 0.8909317  28.40937 0.1649097092
429  429   11.59180 0.8958101  32.80050 0.0200343725
430  430   13.39368 0.8684550  29.37805 0.1173575364
431  431   13.18722 0.8839567  28.31882 0.1910597200
432  432   12.44205 0.8810587  31.40522 0.1878601807
433  433   12.50216 0.8856072  30.63017 0.1723649675
434  434   13.03801 0.8854610  28.96918 0.1171681891
435  435   12.96963 0.8968559  25.07907 0.2192205957
436  436   13.21185 0.8955425  24.59091 0.2027520253
437  437   12.92762 0.8838329  30.32604 0.0289971021
438  438   12.17043 0.8978594  29.19052 0.1161517147
439  439   12.66524 0.8787648  31.53432 0.0696609862
440  440   12.72654 0.8907486  28.89984 0.0916272472
441  441   12.31227 0.8943197  31.14544 0.0710688466
442  442   11.42303 0.8981551  33.39538 0.0530012962
443  443   11.88668 0.8992794  31.16107 0.0562435707
444  444   12.79287 0.8920446  27.48571 0.1660979011
445  445   13.46039 0.8788964  27.85498 0.0801230700
446  446   12.04385 0.9088630  28.87537 0.2506711180
447  447   13.23816 0.8857074  27.19113 0.2142037693
448  448   12.11589 0.9020963  29.11952 0.1251004217
449  449   12.60461 0.9031681  28.46690 0.0738891430
450  450   12.68934 0.8841154  28.68655 0.1777946775
451  451   12.03974 0.8726897  35.43551 0.0299603371
452  452   11.87241 0.9026389  32.41933 0.0254456508
453  453   13.14145 0.8786230  28.48814 0.1313182608
454  454   12.81715 0.8911665  29.33366 0.0941010910
455  455   12.23048 0.8815240  32.91383 0.0437202022
456  456   13.80273 0.8796989  26.60324 0.1746289606
457  457   12.55544 0.8882926  30.56663 0.0991268539
458  458   12.29936 0.8913622  33.04967 0.0475684613
459  459   12.30826 0.8925668  27.98494 0.1924877390
460  460   12.22178 0.9126459  28.73683 0.1241230297
461  461   11.73261 0.8966421  32.11692 0.0472565906
462  462   12.34401 0.9011674  26.76140 0.1412664779
463  463   12.27984 0.8999478  29.94412 0.1832540780
464  464   13.35566 0.8734354  31.52004 0.0740627814
465  465   12.09148 0.9007662  29.90125 0.0932453757
466  466   12.65402 0.8898519  29.16434 0.0950350996
467  467   12.35462 0.8932995  28.18787 0.0816725638
468  468   13.50733 0.8855832  25.36677 0.1077610142
469  469   13.23867 0.8721679  27.75841 0.1480015930
470  470   13.51937 0.8995282  25.31915 0.1799149841
471  471   12.69812 0.8993055  29.54236 0.0962124794
472  472   12.19039 0.8973320  28.44143 0.1535148648
473  473   12.79776 0.8870344  32.24849 0.0310977864
474  474   13.40834 0.8975146  24.54016 0.2135201295
475  475   13.16940 0.8833460  27.26541 0.2140400036
476  476   12.26910 0.8971307  29.17440 0.0705718811
477  477   12.85867 0.8834304  30.06390 0.0492976005
478  478   12.66972 0.8861332  30.15312 0.1590930594
479  479   13.27775 0.8837737  28.27817 0.0725340778
480  480   12.65448 0.8790779  30.38833 0.1386836259
481  481   12.33167 0.8923884  31.12806 0.1157060609
482  482   11.99783 0.9013755  29.68974 0.1613472869
483  483   11.67458 0.8967131  32.73642 0.0946810545
484  484   12.52714 0.8826525  33.12051 0.0527650194
485  485   12.45033 0.8755742  32.15515 0.1332626078
486  486   14.16047 0.8710182  25.26082 0.3130226238
487  487   13.03071 0.8843897  27.54893 0.1241447633
488  488   12.05363 0.8952932  28.74341 0.1597863885
489  489   13.13267 0.8972244  25.44201 0.1028217357
490  490   13.13306 0.8797796  31.71453 0.1487631769
491  491   12.51107 0.8712780  31.57726 0.2069504653
492  492   13.45458 0.8867488  26.05038 0.3237326765
493  493   12.31983 0.8977031  30.28457 0.0580638240
494  494   13.56558 0.8949942  24.48332 0.1630067944
495  495   12.09236 0.8968043  31.85638 0.0613635892
496  496   11.60651 0.8974685  33.06819 0.0430711025
497  497   13.54775 0.8748558  29.02902 0.1125766505
498  498   12.37111 0.8999227  30.10774 0.0064502142
499  499   11.81104 0.8850362  32.43405 0.1394397054
500  500   12.74574 0.8775884  29.59747 0.1580092873</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables" class="level1">
<h1>16.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>var_imp_xgb <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(var_imp_xgb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Feature       Gain      Cover  Frequency
                    &lt;char&gt;      &lt;num&gt;      &lt;num&gt;      &lt;num&gt;
1:                     C.O 0.14680204 0.17124918 0.13509317
2:                      HH 0.14272817 0.11283192 0.09472050
3:                      CI 0.11698867 0.10655330 0.13354037
4:               LS_Factor 0.10349962 0.09190320 0.10093168
5:                 Suelos_ 0.09504059 0.08923479 0.06987578
6: Relative_Slope_Position 0.08200297 0.06906475 0.08074534</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables-1" class="level1">
<h1>17.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>var_imp_xgb_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables  =</span> var_imp_xgb<span class="sc">$</span>Feature,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> var_imp_xgb<span class="sc">$</span>Gain</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>var_imp_xgb_df <span class="ot">&lt;-</span> var_imp_xgb_df[<span class="fu">order</span>(<span class="sc">-</span>var_imp_xgb_df<span class="sc">$</span>importance), ]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_imp_xgb_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   variables importance
1                        C.O 0.14680204
2                         HH 0.14272817
3                         CI 0.11698867
4                  LS_Factor 0.10349962
5                    Suelos_ 0.09504059
6    Relative_Slope_Position 0.08200297
7               Valley_Depth 0.08076350
8                       NDTI 0.07640595
9                      MCARI 0.05991681
10 Topographic_Wetness_Index 0.04884582
11                        HV 0.04700585</code></pre>
</div>
</div>
</section>
<section id="se-grafican-para-entender-cúal-está-influyendo-más-en-el-modelo" class="level1">
<h1>18.Se grafican para entender cúal está influyendo más en el modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>XGBOOTS_Inf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(var_imp_xgb_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(importance),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variables, importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Importancia"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Importancia de variables – XGBoost (Lim_inf)"</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(XGBOOTS_Inf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-grafica-importancia_variables" class="level1">
<h1>19. Guardar grafica Importancia_variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Importancia_variables_XGB_Inf.png"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> XGBOOTS_Inf,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">14</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"cm"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="predicción-y-visualización" class="level1">
<h1>Predicción y visualización</h1>
</section>
<section id="nombres-de-capas-variables-del-modelo" class="level1">
<h1>20. Nombres de capas = variables del modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dataVARS <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"CI"</span>,<span class="st">"C.O"</span>, <span class="st">"MCARI"</span>, <span class="st">"LS_Factor"</span>, <span class="st">"NDTI"</span>, <span class="st">"HV"</span>,<span class="st">"HH"</span>,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"Relative_Slope_Position"</span>, <span class="st">"Suelos_"</span>, <span class="st">"Topographic_Wetness_Index"</span> ,<span class="st">"Valley_Depth"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En terra usamos 'subset' para quedarnos solo con las capas que necesitamos</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Asumiendo que tu objeto raster se llama 'raster' (o cámbiale el nombre)</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>r_predictores <span class="ot">&lt;-</span> <span class="fu">subset</span>(raster, dataVARS)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación de seguridad (Debe salir T</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"¿Están todas las variables?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "¿Están todas las variables?"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">all</span>(dataVARS <span class="sc">%in%</span> <span class="fu">names</span>(r_predictores)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="aplicar-modelo" class="level1">
<h1>21. Aplicar modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>Limite_Inf_XGB <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  r_predictores,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cf">function</span>(model, d, ...) {</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(model, <span class="fu">as.matrix</span>(d))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  Limite_Inf_XGB,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Inferior (XGBoost)"</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-modelo-rf_grid" class="level1">
<h1>22. Guardar modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(Limite_Inf_XGB, <span class="st">"D:/Mapa final/Limite_Inferior_XGB.tif"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
</div>
</section>
<section id="guardar-imagen-png-modelo-rf_grid" class="level1">
<h1>23. Guardar imagen png modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Inferior_XGB.png"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  Limite_Inf_XGB,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Inferior del departamento de Meta y Vichada (XGB)"</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="recorte-de-un-area-especifica" class="level1">
<h1>24. Recorte de un area especifica</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Raster de predicción</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Limite_Inf_XGB   <span class="co"># o rast("Limite_Inferior_XGB.tif")</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Polígono de la zona de interés</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/shp tesis/Altillanura_2.shp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="reproyectar" class="level1">
<h1>25. Reproyectar</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">project</span>(zona, <span class="fu">crs</span>(r))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="cortar-area-de-estudio" class="level1">
<h1>26. Cortar area de estudio</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(r, zona)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">mask</span>(r_crop, zona)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="mapa" class="level1">
<h1>27. Mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r_crop, <span class="at">main =</span> <span class="st">"Predicion Limite Inferior (XGB)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-mapa" class="level1">
<h1>28. Guardar mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/Mapa final/Lim_inf_XGB_Altillanura.tif"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="guardar-mapa-como-imagen" class="level1">
<h1>29. Guardar mapa como imagen</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Inferior_Altillanura_XGB.png"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicion Limite Inferior (XGB)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
