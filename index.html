<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julio César Gaitán Silva">

<title>XGBOOST_Lim_Inf</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="XGBOOST_Lim_Inf_files/libs/clipboard/clipboard.min.js"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/popper.min.js"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="XGBOOST_Lim_Inf_files/libs/quarto-html/anchor.min.js"></script>
<link href="XGBOOST_Lim_Inf_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="XGBOOST_Lim_Inf_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="XGBOOST_Lim_Inf_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="XGBOOST_Lim_Inf_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="XGBOOST_Lim_Inf_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">XGBOOST_Lim_Inf</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julio César Gaitán Silva </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="cargar-librerías" class="level1">
<h1>1. Cargar librerías</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: lattice</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.8.80</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)       <span class="co"># Para trabajar con datos raster</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: sp</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)           <span class="co"># Para manipulación de datos espaciales</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.1, GDAL 3.11.4, PROJ 9.7.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)     <span class="co"># Para manejar archivos Excel</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Conjunto de paquetes para manipulación de datos\library(DataExplorer) # Exploración de datos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ lubridate 1.9.4     ✔ tibble    3.3.0
✔ purrr     1.2.0     ✔ tidyr     1.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract() masks raster::extract(), terra::extract()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ purrr::lift()    masks caret::lift()
✖ dplyr::select()  masks raster::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)        <span class="co"># Visualización de mapas\library(ithir)       # Modelado de suelos</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aqp)         <span class="co"># Análisis de perfiles de suelo</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is aqp 2.2-1

Adjuntando el paquete: 'aqp'

The following objects are masked from 'package:dplyr':

    combine, slice

The following objects are masked from 'package:raster':

    coordinates, metadata, metadata&lt;-, proj4string

The following objects are masked from 'package:sp':

    coordinates, coordinates&lt;-, proj4string, proj4string&lt;-</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'kernlab'

The following object is masked from 'package:purrr':

    cross

The following objects are masked from 'package:raster':

    buffer, rotated

The following objects are masked from 'package:terra':

    buffer, size

The following object is masked from 'package:ggplot2':

    alpha</code></pre>
</div>
</div>
</section>
<section id="carpeta-donde-están-todos-los-rásters-ya-procesados" class="level1">
<h1>2. Carpeta donde están TODOS los rásters ya procesados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">"D:/Meta_vichada/aligned/"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>rasters_sel <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Aspect.tif",</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CI.tif"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"C.O.tif"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Convergence_Index.tif",</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Hillshade.tif",</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HH.tif"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HV.tif"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LS_Factor.tif"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MCARI.tif"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NDTI.tif"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Plan_Curvature.tif",</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Precipitación.tif",</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Profile_Curvature.tif",</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relative_Slope_Position.tif"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suelos_.tif"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Media_.tif",</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Topographic_Wetness_Index.tif"</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Total_Catchment_Area.tif",</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Valley_Depth.tif"</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"GNDVI.tif",</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"BSI.tif",</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Base_Level.tif",</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Distance.tif",</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"DEM.tif",</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"EVI.tif",</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NBR.tif",</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDVI.tif",</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDWI.tif",</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"SAVI.tif",</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Slope.tif"</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Maxima_.tif",</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Minima_.tif",</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="construir-rutas-completas-solo-de-los-seleccionados" class="level1">
<h1>3. Construir rutas completas SOLO de los seleccionados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ruta, rasters_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificar-cuáles-existen-control-de-errores" class="level1">
<h1>4. Verificar cuáles existen (control de errores)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> files_sel[<span class="fu">file.exists</span>(files_sel)]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Si alguno falta, aquí lo ves</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">basename</span>(files_sel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CI.tif"                        "C.O.tif"                      
 [3] "HH.tif"                        "HV.tif"                       
 [5] "LS_Factor.tif"                 "MCARI.tif"                    
 [7] "NDTI.tif"                      "Relative_Slope_Position.tif"  
 [9] "Suelos_.tif"                   "Topographic_Wetness_Index.tif"
[11] "Valley_Depth.tif"             </code></pre>
</div>
</div>
</section>
<section id="cargar-como-spatraster" class="level1">
<h1>5. Cargar como SpatRaster</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>raster <span class="ot">&lt;-</span> <span class="fu">rast</span>(files_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificación-rápida" class="level1">
<h1>6. Verificación rápida</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareGeom</span>(raster, raster[[<span class="dv">1</span>]], <span class="at">stopOnError =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="visualización" class="level1">
<h1>7. Visualización</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="obtener-coordenadas-únicas" class="level1">
<h1>8. Obtener coordenadas únicas</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>SCHS <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/SCHS.xlsx"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Coor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Perfil_COD1=</span>SCHS<span class="sc">$</span>Perfil_COD1,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Latitud =</span> SCHS<span class="sc">$</span>Latitud,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Longitud =</span> SCHS<span class="sc">$</span>Longitud,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Lim_inf =</span> SCHS<span class="sc">$</span>lim_inf )</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Coor)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Coor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   225 obs. of  4 variables:
 $ Perfil_COD1: chr  "AR-011" "AR-021" "AR-026" "AR-043" ...
 $ Latitud    : num  3.36 3.5 3.46 3.38 4.5 ...
 $ Longitud   : num  -73.7 -74 -73.9 -73.7 -71.3 ...
 $ Lim_inf    : num  40.2 43.7 36.9 54.4 87.4 ...</code></pre>
</div>
</div>
</section>
<section id="convertir-a-formato-espacial-sf" class="level1">
<h1>9. Convertir a formato espacial (sf)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_final_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="at">x =</span> Coor,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitud"</span>, <span class="st">"Latitud"</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_final_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizar-los-puntos-sobre-el-modelo-de-elevación-dem" class="level1">
<h1>10. Visualizar los puntos sobre el modelo de elevación (DEM)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster<span class="sc">$</span>Topographic_Wetness_Index)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(data_final_sf), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualización-con-tmap" class="level1">
<h1>11. Visualización con tmap</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(raster<span class="sc">$</span>Topographic_Wetness_Index) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#CCCCCC"</span>, <span class="st">"#999999"</span>, <span class="st">"#666666"</span>, <span class="st">"#333333"</span>, <span class="st">"#000000"</span>)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(data_final_sf) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="st">"Lim_sup"</span>, <span class="at">palette =</span> <span class="st">"-RdYlBu"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="st">"Mapa Lim_Sup cm"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_tm_raster()`: migrate the argument(s) related to the scale of the
visual variable `col` namely 'palette' (rename to 'values') to col.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_tm_dots()`: migrate the argument(s) related to the scale of the
visual variable `fill` namely 'palette' (rename to 'values') to fill.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_layout()`: use `tm_title()` instead of `tm_layout(title = )`
! `tm_scale_bar()` is deprecated. Please use `tm_scalebar()` instead.
SpatRaster object downsampled to 2505 by 3993 cells.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extraer-valores-raster-en-los-puntos-espaciales" class="level1">
<h1>12. Extraer valores raster en los puntos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>extraccion <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(raster, <span class="fu">vect</span>(data_final_sf))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_sf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_final_sf, extraccion[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span> (data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="modelamiento--" class="level1">
<h1>Modelamiento —————————————————————-</h1>
</section>
<section id="resumen-de-los-datos-espaciales" class="level1">
<h1>13. Resumen de los datos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Perfil_COD1           Lim_inf             CI              C.O       
 Length:225         Min.   : 14.00   Min.   :0.1548   Min.   :16.10  
 Class :character   1st Qu.: 38.01   1st Qu.:0.5939   1st Qu.:22.62  
 Mode  :character   Median : 50.20   Median :0.7866   Median :25.25  
                    Mean   : 59.87   Mean   :0.9230   Mean   :26.68  
                    3rd Qu.: 76.00   3rd Qu.:1.1672   3rd Qu.:31.79  
                    Max.   :180.00   Max.   :2.3920   Max.   :70.25  
       HH                HV            LS_Factor             MCARI         
 Min.   :-21.077   Min.   :-31.215   Min.   : 0.000109   Min.   :0.008303  
 1st Qu.:-14.270   1st Qu.:-23.700   1st Qu.: 0.187458   1st Qu.:0.048938  
 Median :-11.418   Median :-19.620   Median : 0.400085   Median :0.062091  
 Mean   :-11.621   Mean   :-19.575   Mean   : 1.368948   Mean   :0.063347  
 3rd Qu.: -8.405   3rd Qu.:-15.374   3rd Qu.: 1.022462   3rd Qu.:0.077835  
 Max.   : -2.833   Max.   : -8.273   Max.   :42.507114   Max.   :0.133466  
      NDTI         Relative_Slope_Position    Suelos_     
 Min.   :0.02205   Min.   :0.000000        Min.   : 0.00  
 1st Qu.:0.16568   1st Qu.:0.001673        1st Qu.: 4.00  
 Median :0.18370   Median :0.008315        Median :17.00  
 Mean   :0.17972   Mean   :0.037083        Mean   :23.09  
 3rd Qu.:0.20163   3rd Qu.:0.033621        3rd Qu.:40.00  
 Max.   :0.23763   Max.   :0.781887        Max.   :57.00  
 Topographic_Wetness_Index  Valley_Depth              geometry  
 Min.   : 5.026            Min.   :  4.941   POINT        :225  
 1st Qu.: 7.364            1st Qu.:121.764   epsg:4326    :  0  
 Median : 8.340            Median :195.087   +proj=long...:  0  
 Mean   : 9.751            Mean   :237.062                      
 3rd Qu.:10.840            3rd Qu.:304.421                      
 Max.   :25.343            Max.   :770.234                      </code></pre>
</div>
</div>
</section>
<section id="convertir-a-dataframe-para-modelado-no-se-tiene-en-cuenta-la-columna-id" class="level1">
<h1>14. Convertir a dataframe para modelado, no se tiene en cuenta la columna ID</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(data_sf)[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_sf_df)<span class="co">#</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Lim_inf             CI              C.O              HH         
 Min.   : 14.00   Min.   :0.1548   Min.   :16.10   Min.   :-21.077  
 1st Qu.: 38.01   1st Qu.:0.5939   1st Qu.:22.62   1st Qu.:-14.270  
 Median : 50.20   Median :0.7866   Median :25.25   Median :-11.418  
 Mean   : 59.87   Mean   :0.9230   Mean   :26.68   Mean   :-11.621  
 3rd Qu.: 76.00   3rd Qu.:1.1672   3rd Qu.:31.79   3rd Qu.: -8.405  
 Max.   :180.00   Max.   :2.3920   Max.   :70.25   Max.   : -2.833  
       HV            LS_Factor             MCARI               NDTI        
 Min.   :-31.215   Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.:-23.700   1st Qu.: 0.187458   1st Qu.:0.048938   1st Qu.:0.16568  
 Median :-19.620   Median : 0.400085   Median :0.062091   Median :0.18370  
 Mean   :-19.575   Mean   : 1.368948   Mean   :0.063347   Mean   :0.17972  
 3rd Qu.:-15.374   3rd Qu.: 1.022462   3rd Qu.:0.077835   3rd Qu.:0.20163  
 Max.   : -8.273   Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001673        1st Qu.: 4.00   1st Qu.: 7.364           
 Median :0.008315        Median :17.00   Median : 8.340           
 Mean   :0.037083        Mean   :23.09   Mean   : 9.751           
 3rd Qu.:0.033621        3rd Qu.:40.00   3rd Qu.:10.840           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth    
 Min.   :  4.941  
 1st Qu.:121.764  
 Median :195.087  
 Mean   :237.062  
 3rd Qu.:304.421  
 Max.   :770.234  </code></pre>
</div>
</div>
</section>
<section id="mejor-semilla-particion-de-datos-y-mejor-modelo" class="level1">
<h1>15.Mejor Semilla particion de datos y mejor modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data_sf_df<span class="sc">$</span>Lim_inf</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> data_sf_df[, <span class="sc">!</span>(<span class="fu">names</span>(data_sf_df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Lim_inf"</span>))]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>resultados_Lim_Inf_XGB <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="fu">integer</span>(),</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_test =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_test =</span> <span class="fu">numeric</span>()</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>best_rmse  <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>best_seed  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>) {</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(s)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(y, <span class="at">p =</span> <span class="fl">0.70</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  X_train <span class="ot">&lt;-</span> X[index, ]</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  X_test  <span class="ot">&lt;-</span> X[<span class="sc">-</span>index, ]</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  y_train <span class="ot">&lt;-</span> y[index]</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  y_test  <span class="ot">&lt;-</span> y[<span class="sc">-</span>index]</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  dtrain <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(X_train, <span class="at">label =</span> y_train)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  dtest  <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(X_test,  <span class="at">label =</span> y_test)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">objective =</span> <span class="st">"reg:squarederror"</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta =</span> <span class="fl">0.05</span>,</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_depth =</span> <span class="dv">3</span>,</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subsample =</span> <span class="fl">0.8</span>,</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">colsample_bytree =</span> <span class="fl">0.8</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> params,</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dtrain,</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrounds =</span> <span class="dv">100</span>,</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="dv">0</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ===== MÉTRICAS TRAIN</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  pred_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, dtrain)</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>  RMSE_train <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_train, y_train)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  R2_train   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred_train, y_train)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ===== MÉTRICAS </span><span class="al">TEST</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, dtest)</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  RMSE_test <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_test, y_test)</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  R2_test   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred_test, y_test)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  resultados_Lim_Inf_XGB <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    resultados_Lim_Inf_XGB,</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> s,</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_train =</span> RMSE_train,</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_train =</span> R2_train,</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_test =</span> RMSE_test,</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_test =</span> R2_test</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (RMSE_test <span class="sc">&lt;</span> best_rmse) {</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>    best_rmse  <span class="ot">&lt;-</span> RMSE_test</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> modelo</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>    best_seed  <span class="ot">&lt;-</span> s</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>best_seed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 178</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>best_rmse</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.28467</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>best_model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>##### xgb.Booster
call:
  xgb.train(params = params, data = dtrain, nrounds = 100, verbose = 0)
# of features: 11 
# of rounds:  100 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados_Lim_Inf_XGB)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    seed RMSE_train  R2_train RMSE_test      R2_test
1      1   13.63231 0.8863687  30.65754 1.440789e-01
2      2   13.84008 0.8699302  31.02899 1.831685e-01
3      3   12.76372 0.8835774  34.94032 3.128375e-02
4      4   13.65009 0.8802080  29.31449 1.021864e-01
5      5   12.60113 0.8881532  33.85256 1.616258e-01
6      6   14.89760 0.8644224  27.89833 1.704240e-01
7      7   13.41743 0.8789178  31.06097 1.121662e-01
8      8   11.90822 0.8883424  35.06419 1.081951e-01
9      9   13.32605 0.8765159  33.42457 1.426029e-02
10    10   13.30932 0.8727700  31.55039 1.211823e-01
11    11   12.98897 0.8861131  33.67859 1.216747e-01
12    12   13.73934 0.8796646  29.78756 1.653398e-01
13    13   11.92203 0.9050801  33.32216 3.239050e-02
14    14   13.37314 0.8670907  34.49479 3.755787e-02
15    15   14.04858 0.8723605  28.74233 1.575957e-01
16    16   13.75060 0.8698691  31.39363 1.492230e-01
17    17   13.56280 0.8727582  30.40240 9.688305e-02
18    18   13.97456 0.8779816  27.89649 2.358130e-01
19    19   13.44479 0.8669986  33.96112 1.044455e-01
20    20   13.99207 0.8883766  28.55178 1.305271e-01
21    21   12.79070 0.8857127  35.83382 3.038926e-02
22    22   13.65322 0.8859751  29.44689 7.167742e-02
23    23   13.26984 0.8806668  30.44512 1.849857e-01
24    24   13.48237 0.8857325  28.26221 1.322993e-01
25    25   14.15882 0.8846140  27.32932 1.323076e-01
26    26   12.84371 0.8803319  32.89800 7.377101e-02
27    27   13.71452 0.8526688  34.27188 5.748343e-02
28    28   14.03003 0.8541469  30.17694 2.044748e-01
29    29   13.82609 0.8782763  29.69409 2.390727e-02
30    30   14.24900 0.8809582  25.98323 2.905927e-01
31    31   12.72011 0.8899319  35.28492 1.214736e-02
32    32   12.81247 0.8908612  31.36785 7.039136e-02
33    33   13.54111 0.8774507  30.97430 1.655557e-01
34    34   13.58257 0.8771074  31.21539 2.008042e-01
35    35   13.29501 0.8718345  34.89464 2.345549e-02
36    36   13.08213 0.8868921  32.42398 7.888793e-03
37    37   13.85741 0.8854082  30.14410 1.051858e-01
38    38   12.88095 0.9001068  31.23402 1.014891e-01
39    39   12.26384 0.8927673  33.09641 9.196810e-02
40    40   15.25213 0.8596147  28.02411 1.907072e-01
41    41   13.41793 0.8822017  31.91948 3.162068e-02
42    42   13.38935 0.8951452  30.44317 1.640026e-01
43    43   13.79430 0.8758138  30.53149 1.212033e-01
44    44   12.96010 0.8891583  31.70472 1.867225e-01
45    45   12.43021 0.8819947  35.31303 7.756024e-02
46    46   14.15155 0.8773602  28.51482 1.456334e-01
47    47   13.59338 0.8775910  31.24805 3.968820e-02
48    48   13.29930 0.8871800  30.31945 7.160219e-02
49    49   14.51544 0.8608261  28.56041 1.977496e-01
50    50   15.01729 0.8572922  28.01243 2.186796e-01
51    51   13.83643 0.8672912  31.26457 1.218650e-01
52    52   12.94998 0.8724727  34.49017 6.624122e-02
53    53   15.15715 0.8708289  23.00318 4.084595e-01
54    54   12.05740 0.9015549  36.68327 7.633678e-02
55    55   12.75087 0.8829210  32.77614 7.823942e-02
56    56   14.49393 0.8684716  26.87792 1.952494e-01
57    57   13.61302 0.8704092  33.08692 9.864790e-02
58    58   12.93308 0.8804264  32.55282 1.602259e-01
59    59   13.03415 0.8692768  34.87327 6.183233e-02
60    60   13.59652 0.8757971  30.23292 1.194493e-01
61    61   14.32859 0.8630943  28.51487 1.710602e-01
62    62   13.00464 0.8887549  31.27045 1.420648e-01
63    63   13.33568 0.8778505  32.81384 8.561952e-02
64    64   13.21104 0.8962419  28.58024 1.749956e-01
65    65   13.83857 0.8788684  27.39886 1.244977e-01
66    66   13.96398 0.8816204  28.19512 1.337998e-01
67    67   12.46791 0.8892551  33.19879 7.811663e-02
68    68   12.75689 0.8898080  31.99920 9.601785e-02
69    69   13.39083 0.8863100  31.52842 6.412351e-02
70    70   13.85589 0.8695344  30.47452 1.109353e-01
71    71   13.17823 0.8831790  31.60264 1.057013e-01
72    72   13.31659 0.8895210  29.03093 1.599250e-01
73    73   13.74595 0.8707355  31.80549 1.414605e-01
74    74   12.74884 0.8785667  34.39690 2.953540e-02
75    75   14.44355 0.8755072  28.78380 1.834460e-01
76    76   12.46387 0.9007837  33.40728 1.045120e-01
77    77   13.81310 0.8843475  29.02707 2.464057e-01
78    78   12.83693 0.8810014  34.58976 3.269843e-02
79    79   14.79465 0.8571401  26.79411 2.010134e-01
80    80   14.48419 0.8589800  28.13820 2.451892e-01
81    81   13.82145 0.8807552  28.28950 1.377618e-01
82    82   13.37435 0.8861090  30.31834 2.071538e-01
83    83   12.86445 0.8707785  35.86697 2.949386e-02
84    84   13.77945 0.8856833  27.36267 1.417809e-01
85    85   13.90001 0.8777778  28.50684 2.044549e-01
86    86   14.34405 0.8756175  29.05900 6.077994e-02
87    87   13.55546 0.8887485  28.77791 1.636254e-01
88    88   12.45029 0.8810971  35.12838 4.970403e-02
89    89   12.92743 0.8851413  33.59484 6.867271e-02
90    90   13.28650 0.8852653  32.74096 4.559229e-02
91    91   12.78608 0.8892836  32.97964 2.117314e-02
92    92   13.01625 0.8901547  30.26784 8.354660e-02
93    93   15.14643 0.8608489  26.52445 2.305681e-01
94    94   13.71969 0.8718750  29.94041 1.514189e-01
95    95   13.45032 0.8752382  31.66357 1.331022e-01
96    96   13.86488 0.8735270  29.95016 1.081661e-01
97    97   12.88964 0.8944511  30.93599 1.176214e-01
98    98   13.15373 0.8919389  30.58452 1.106207e-01
99    99   13.98093 0.8714041  29.41162 1.785180e-01
100  100   14.65885 0.8694523  26.28973 2.591038e-01
101  101   14.48502 0.8701963  29.82417 5.848004e-02
102  102   13.96286 0.8760302  29.12696 6.553663e-02
103  103   13.02628 0.8880804  31.92080 1.798362e-01
104  104   13.05075 0.8901697  29.58950 1.230752e-01
105  105   14.99359 0.8480733  27.89821 1.216391e-01
106  106   14.07915 0.8829220  28.68059 1.628807e-01
107  107   14.33988 0.8802107  28.37144 1.079618e-01
108  108   14.08659 0.8661143  31.21790 7.691970e-02
109  109   14.23732 0.8867319  26.34058 1.960874e-01
110  110   14.67992 0.8631598  29.55730 1.222065e-01
111  111   14.04499 0.8843078  26.43278 1.834739e-01
112  112   14.40794 0.8807671  29.04263 9.059585e-02
113  113   14.02246 0.8811985  30.04599 1.970437e-01
114  114   13.43365 0.8833481  32.39920 1.056606e-01
115  115   14.35563 0.8689452  28.86710 8.994154e-02
116  116   13.65049 0.8735825  30.86152 9.803928e-02
117  117   13.66061 0.8821001  29.65637 1.361144e-01
118  118   13.29941 0.8786145  34.01012 2.184641e-02
119  119   13.94749 0.8821886  29.02913 1.457947e-01
120  120   14.34453 0.8745202  27.24752 1.000812e-01
121  121   13.59717 0.8965957  30.97511 2.111228e-01
122  122   13.06214 0.8765066  33.25989 1.296953e-01
123  123   13.38683 0.8788642  30.92814 7.280540e-02
124  124   12.93653 0.8912411  30.99148 8.553393e-02
125  125   14.65884 0.8796727  25.69518 2.045327e-01
126  126   13.57848 0.8615823  31.40509 1.714949e-01
127  127   13.87929 0.8836808  27.48958 2.262676e-01
128  128   12.20603 0.9000822  33.35016 7.373642e-02
129  129   11.84427 0.8980967  34.35105 5.347107e-02
130  130   12.47344 0.8803874  35.42785 5.231704e-02
131  131   14.09460 0.8731880  30.13880 1.027243e-01
132  132   14.23660 0.8650893  29.99785 1.456696e-01
133  133   14.32876 0.8585346  34.03933 4.841622e-02
134  134   12.50849 0.8881385  34.17257 1.017962e-01
135  135   13.91881 0.8833592  30.06611 8.415914e-02
136  136   15.08142 0.8372062  31.59834 1.789453e-01
137  137   13.10104 0.8896480  30.64684 2.627792e-01
138  138   14.06475 0.8665253  29.64080 1.487656e-01
139  139   12.69860 0.8888694  32.27219 1.160568e-01
140  140   11.92970 0.8956085  34.87673 2.160733e-02
141  141   13.02923 0.8887570  32.54281 1.878800e-01
142  142   12.67661 0.8894135  34.24431 7.304218e-03
143  143   14.47444 0.8645852  29.39198 1.526673e-01
144  144   12.75837 0.8686582  37.25836 5.108789e-02
145  145   13.56618 0.8735957  30.52118 2.095172e-01
146  146   13.54365 0.8895157  29.80320 8.802063e-02
147  147   14.29925 0.8467392  31.70545 2.046183e-01
148  148   12.34279 0.8968262  32.00135 7.023415e-02
149  149   12.54704 0.8785176  35.14166 1.246093e-01
150  150   12.93261 0.8726037  34.37414 1.022369e-01
151  151   14.50764 0.8747188  28.05688 9.789713e-02
152  152   14.21944 0.8827936  27.48898 2.194713e-01
153  153   14.47446 0.8695890  29.21695 1.996970e-01
154  154   13.61578 0.8831690  31.10685 5.057998e-02
155  155   13.99075 0.8760243  30.04484 1.975847e-01
156  156   12.96388 0.8896130  33.63693 1.002670e-01
157  157   15.21165 0.8526405  27.23198 2.643655e-01
158  158   13.28937 0.8680200  33.13532 1.004599e-01
159  159   13.21904 0.8907039  31.20096 7.194553e-02
160  160   14.97979 0.8372965  30.99250 1.217944e-01
161  161   14.63664 0.8638436  27.15353 2.398261e-01
162  162   13.90270 0.8628675  30.29940 6.027777e-02
163  163   13.60234 0.8820234  29.70658 8.444362e-02
164  164   13.42205 0.8871319  30.39469 8.187249e-02
165  165   14.31221 0.8791892  26.78077 2.094244e-01
166  166   13.99977 0.8959675  25.18459 2.358989e-01
167  167   13.05061 0.8850924  32.28102 3.877597e-02
168  168   12.64198 0.8839116  34.31342 2.896190e-02
169  169   13.60418 0.8845168  29.35617 1.285572e-01
170  170   12.72932 0.8935196  31.15963 9.200516e-02
171  171   12.89224 0.8815447  33.28784 4.087260e-02
172  172   12.70581 0.8832433  31.87934 1.186102e-01
173  173   13.88470 0.8660712  33.56625 5.932438e-02
174  174   14.28625 0.8678508  27.48528 1.213823e-01
175  175   13.94860 0.8851681  28.64315 7.567447e-02
176  176   13.88740 0.8927506  26.70165 2.268232e-01
177  177   12.48631 0.8868741  34.80712 1.023317e-01
178  178   15.38513 0.8743179  21.28467 2.566830e-01
179  179   12.23284 0.8846771  37.12064 3.849444e-02
180  180   13.11764 0.8851914  34.00762 8.510793e-02
181  181   12.90625 0.8841725  33.04263 1.157334e-01
182  182   14.66111 0.8687026  27.53174 1.542844e-01
183  183   12.79456 0.8767105  33.33501 1.641420e-01
184  184   13.57523 0.8745840  30.72038 1.414005e-01
185  185   13.02154 0.8963589  29.32800 1.045415e-01
186  186   14.19542 0.8728320  29.86569 5.281585e-02
187  187   12.88855 0.8731249  34.41184 9.450922e-02
188  188   13.54953 0.8754137  30.66680 1.904723e-01
189  189   12.74908 0.8880460  34.11783 4.335470e-02
190  190   13.33921 0.8831973  30.02725 5.679694e-02
191  191   13.98921 0.8868412  26.18789 1.547184e-01
192  192   13.94094 0.8396471  34.75925 1.874472e-01
193  193   13.07216 0.8825003  31.37272 4.737986e-02
194  194   12.84101 0.8881628  32.96747 6.315388e-02
195  195   13.37238 0.8938848  28.18353 8.544930e-02
196  196   14.60170 0.8623557  27.10190 2.471993e-01
197  197   14.68345 0.8695774  28.33943 5.828080e-02
198  198   13.14384 0.8729951  34.20386 5.714123e-02
199  199   13.46980 0.8834875  29.76039 1.493319e-01
200  200   14.15179 0.8707620  28.97581 1.547237e-01
201  201   13.93307 0.8936517  29.58739 1.887005e-01
202  202   13.54162 0.8862349  31.77645 6.900456e-02
203  203   13.14327 0.8743561  34.16429 1.104529e-01
204  204   13.04181 0.8735249  35.00243 6.996043e-02
205  205   13.75333 0.8600883  33.21597 5.018985e-02
206  206   14.18934 0.8913992  27.42445 1.269290e-01
207  207   13.19328 0.8884349  31.52962 6.384798e-02
208  208   12.41737 0.8815925  35.37176 6.162783e-02
209  209   13.74551 0.8686161  32.13126 9.076170e-02
210  210   14.03876 0.8630146  32.31756 8.411037e-02
211  211   14.20472 0.8721675  29.45106 8.937977e-02
212  212   12.83396 0.8883959  32.44732 7.745588e-02
213  213   13.89680 0.8727004  30.27577 1.295142e-01
214  214   14.52820 0.8609447  29.60744 1.365077e-01
215  215   12.02448 0.9066449  31.87941 3.052085e-02
216  216   12.04677 0.8916873  35.72722 1.939274e-02
217  217   13.71772 0.8658972  32.05200 7.243667e-02
218  218   13.91522 0.8874645  27.95745 1.857312e-01
219  219   14.14617 0.8675586  31.76346 5.258329e-02
220  220   13.35479 0.8844805  29.48272 1.045495e-01
221  221   13.38761 0.8866350  30.42707 1.238095e-01
222  222   12.25349 0.8981674  34.40399 2.579483e-02
223  223   12.83729 0.8794628  35.48427 4.511651e-02
224  224   12.81751 0.8806504  34.26529 2.177074e-02
225  225   13.92103 0.8742532  31.90907 9.261110e-02
226  226   13.72886 0.8725044  31.31298 1.741720e-01
227  227   12.98451 0.8775557  34.01812 4.165950e-02
228  228   12.92928 0.8873886  32.74600 9.448619e-02
229  229   13.50282 0.8819045  30.94007 8.025000e-02
230  230   13.28121 0.8973356  31.73672 1.226118e-01
231  231   13.98934 0.8677749  31.06375 1.372898e-01
232  232   14.11111 0.8762294  27.33528 1.006448e-01
233  233   13.10079 0.8856091  32.90211 5.520830e-02
234  234   13.99914 0.8722276  30.54349 2.010250e-01
235  235   13.12036 0.8933842  30.73479 1.843470e-01
236  236   14.12648 0.8731332  28.74481 4.476900e-02
237  237   14.84274 0.8589747  28.56949 1.939878e-01
238  238   13.63949 0.8938899  31.01752 8.497899e-02
239  239   13.95763 0.8763437  27.87009 1.365221e-01
240  240   13.17515 0.8824139  32.46497 5.928741e-02
241  241   14.18246 0.8831839  26.39325 2.679443e-01
242  242   12.73304 0.8757232  34.96230 1.217319e-01
243  243   13.26801 0.8981533  29.84383 7.852950e-02
244  244   13.01870 0.8794251  35.06232 2.825007e-02
245  245   13.28124 0.8750668  31.53633 2.357766e-01
246  246   14.79966 0.8674977  26.33253 1.655927e-01
247  247   13.16319 0.8821767  30.53575 1.389973e-01
248  248   14.02906 0.8757507  27.87516 1.189075e-01
249  249   14.25067 0.8743808  28.00206 1.304138e-01
250  250   14.20372 0.8897375  24.92603 1.631309e-01
251  251   13.05243 0.8848482  33.75823 1.705623e-02
252  252   14.84386 0.8624275  25.97686 1.526386e-01
253  253   14.41704 0.8835320  27.06827 1.805567e-01
254  254   12.88109 0.8762637  34.97312 6.834437e-02
255  255   14.71522 0.8679431  25.61659 2.160475e-01
256  256   13.17243 0.8728160  32.38616 1.899520e-01
257  257   14.06219 0.8683899  31.75204 1.068972e-01
258  258   12.87883 0.8841864  34.63392 1.564594e-02
259  259   13.23854 0.8827973  33.39120 1.699075e-01
260  260   12.54543 0.9097260  29.76440 3.200990e-02
261  261   13.30373 0.8926642  30.25273 1.877123e-01
262  262   13.23725 0.8833587  31.16161 7.269339e-02
263  263   13.50256 0.8834082  31.93057 2.500722e-02
264  264   11.37670 0.9160665  32.93098 9.280663e-02
265  265   13.42469 0.8929812  28.50160 8.555975e-02
266  266   14.05079 0.8680468  28.98443 2.190866e-01
267  267   14.27835 0.8757414  29.13665 1.408334e-01
268  268   14.33514 0.8618480  31.09554 5.871005e-02
269  269   14.47601 0.8777581  26.86452 1.687215e-01
270  270   12.93750 0.8842930  34.34003 7.834251e-02
271  271   13.80125 0.8775965  29.78683 9.835642e-02
272  272   12.89290 0.8909637  29.07414 1.111623e-01
273  273   12.55013 0.8749801  35.59358 4.564534e-02
274  274   12.71567 0.8947209  32.03986 3.613835e-02
275  275   14.21040 0.8779099  25.40569 1.685042e-01
276  276   12.75126 0.8825903  33.42626 1.166805e-01
277  277   13.76681 0.8828393  29.54825 2.277967e-02
278  278   14.82616 0.8839445  22.68179 1.797916e-01
279  279   13.16710 0.8801155  32.02360 1.224997e-01
280  280   14.75536 0.8583460  30.52381 1.261508e-01
281  281   12.75657 0.8841604  33.07154 1.122726e-01
282  282   12.98560 0.8861103  33.34141 8.641989e-02
283  283   13.43929 0.8732162  31.82114 1.372923e-01
284  284   14.74534 0.8763230  24.72424 2.413710e-01
285  285   13.17826 0.8782601  31.49241 1.285670e-01
286  286   14.38211 0.8786502  27.37894 1.758024e-01
287  287   12.79301 0.9028424  31.67753 7.659095e-02
288  288   13.35883 0.8784251  33.22307 3.417208e-02
289  289   14.62975 0.8679313  28.16864 2.672122e-01
290  290   13.93929 0.8687828  31.49525 1.812783e-01
291  291   11.36423 0.8988934  38.40531 4.722482e-03
292  292   12.90770 0.8923704  32.23100 3.358071e-02
293  293   14.14762 0.8720994  29.35148 8.783553e-02
294  294   13.58815 0.8639775  31.44127 1.682502e-01
295  295   13.34341 0.8713844  31.77576 8.514027e-02
296  296   14.75227 0.8711879  25.87886 2.043520e-01
297  297   13.21412 0.8705853  33.95810 1.321583e-02
298  298   15.33185 0.8546293  25.51208 3.209380e-01
299  299   13.16018 0.8868706  31.84343 1.065722e-01
300  300   14.43298 0.8571202  32.46286 1.343293e-01
301  301   12.32439 0.8893656  35.09451 1.145313e-01
302  302   15.24765 0.8592111  25.29658 2.025863e-01
303  303   14.06902 0.8635689  31.48261 3.450168e-01
304  304   14.34774 0.8773814  27.30137 9.437703e-02
305  305   13.94698 0.8717199  30.68906 1.113833e-01
306  306   13.28640 0.8809281  33.63070 6.668720e-03
307  307   13.89036 0.8730324  28.45591 1.027568e-01
308  308   13.48907 0.8833415  31.28786 1.082334e-01
309  309   12.99694 0.8958469  29.28938 1.083158e-01
310  310   12.86449 0.8901076  31.36029 1.128714e-01
311  311   12.73147 0.8973662  32.17910 1.105045e-01
312  312   13.72583 0.8712717  33.43772 5.579142e-02
313  313   14.22008 0.8756502  30.06821 4.306904e-02
314  314   14.78412 0.8687964  26.88755 1.188357e-01
315  315   14.70504 0.8731433  26.91495 1.024048e-01
316  316   14.30564 0.8837350  27.84596 1.754464e-01
317  317   12.55361 0.8854271  33.64756 4.939135e-02
318  318   13.09627 0.8899167  32.65384 8.948955e-02
319  319   12.23489 0.8830705  36.44455 5.951493e-02
320  320   13.24095 0.8766630  31.21012 1.394148e-01
321  321   14.00979 0.8524941  31.62016 2.156866e-01
322  322   12.96855 0.8840128  32.71475 9.403562e-02
323  323   13.81198 0.8679094  30.92315 2.080594e-01
324  324   13.87994 0.8752781  30.34684 9.963880e-02
325  325   14.24555 0.8766655  29.31830 7.604741e-02
326  326   13.92934 0.8772823  30.76145 7.669564e-02
327  327   13.12442 0.8777860  33.71510 1.488865e-01
328  328   13.31062 0.8782536  32.65050 6.961977e-02
329  329   13.62389 0.8671612  30.56656 2.367323e-01
330  330   12.18095 0.8990514  32.81776 1.622809e-01
331  331   14.65900 0.8648458  28.71237 1.128218e-01
332  332   13.19620 0.8833796  31.87013 5.369009e-02
333  333   14.33635 0.8704033  29.42110 5.890393e-02
334  334   13.06517 0.8789431  32.85479 4.197147e-02
335  335   15.40824 0.8622228  23.54323 3.117556e-01
336  336   13.30236 0.8908012  30.57083 4.939238e-02
337  337   13.43451 0.8865051  30.60308 4.618272e-02
338  338   13.67779 0.8929292  29.22618 3.730122e-02
339  339   12.52487 0.8958662  33.48046 4.955239e-02
340  340   12.94308 0.8836371  33.85818 9.204149e-02
341  341   13.34881 0.8699143  33.78956 7.784576e-02
342  342   13.44131 0.8747798  32.60101 8.683781e-02
343  343   13.41535 0.8895207  27.84943 1.794388e-01
344  344   14.59309 0.8750744  27.87718 1.977635e-01
345  345   12.54963 0.8872128  36.11280 5.299513e-03
346  346   12.91756 0.8856140  34.10493 1.073378e-01
347  347   13.37996 0.8784121  31.92493 8.902475e-02
348  348   13.56970 0.8812424  29.26216 7.723597e-02
349  349   12.88034 0.8982701  30.85075 1.089967e-01
350  350   13.98629 0.8700186  31.19914 6.233079e-02
351  351   13.29146 0.8801176  30.71101 9.630355e-02
352  352   14.45873 0.8743921  25.21979 3.068888e-01
353  353   14.48678 0.8776424  26.41658 9.895987e-02
354  354   13.52238 0.8891613  28.70677 1.286536e-01
355  355   13.52379 0.8925594  30.48993 1.240205e-01
356  356   13.05691 0.8897356  31.42219 6.308957e-02
357  357   12.81930 0.8756227  36.45545 1.143691e-02
358  358   12.33921 0.9158015  32.48568 8.323646e-02
359  359   13.90353 0.8753504  30.09302 6.440980e-02
360  360   12.73297 0.8963780  33.72607 1.014207e-01
361  361   13.50397 0.8732468  31.54522 7.721697e-02
362  362   14.68427 0.8585788  30.15696 2.259937e-01
363  363   13.47616 0.8811379  31.32350 1.360898e-01
364  364   12.27985 0.8957358  34.24520 1.261345e-01
365  365   14.31681 0.8855306  26.57148 2.777203e-01
366  366   13.39705 0.8870428  30.26544 7.868820e-02
367  367   12.76254 0.8932194  31.77821 7.843878e-02
368  368   13.40587 0.8789569  31.37444 1.013726e-01
369  369   13.74913 0.8732168  30.61738 1.105053e-01
370  370   13.53029 0.8919760  29.52487 9.648810e-02
371  371   14.60123 0.8692756  27.63853 1.471647e-01
372  372   13.26161 0.8935584  30.74444 4.530371e-02
373  373   12.73025 0.8869817  34.42819 2.405146e-03
374  374   12.76236 0.8791030  34.04681 1.251188e-01
375  375   13.26637 0.8897508  30.46773 8.722185e-02
376  376   14.17580 0.8740837  29.39584 1.674992e-01
377  377   14.61792 0.8625485  27.98781 2.039921e-01
378  378   13.71219 0.8792026  32.06410 1.742576e-02
379  379   13.61868 0.8667947  32.63896 6.975644e-02
380  380   14.50049 0.8760594  26.55336 9.370725e-02
381  381   14.17981 0.8738591  29.77029 7.065973e-02
382  382   13.27737 0.8686479  33.59656 1.056892e-01
383  383   13.89200 0.8871740  28.18947 9.353910e-02
384  384   14.14131 0.8743337  28.82048 1.089373e-01
385  385   13.47859 0.8806402  31.16167 7.253515e-02
386  386   13.76156 0.8781347  29.24120 1.538770e-01
387  387   13.33920 0.8844323  30.57641 2.125035e-01
388  388   14.53886 0.8749667  29.24429 1.297135e-01
389  389   12.82608 0.9058879  31.08056 1.380325e-01
390  390   13.15997 0.8920928  31.99583 8.127771e-02
391  391   13.80868 0.8683574  33.58344 7.760785e-02
392  392   12.59542 0.8798564  33.21201 1.088713e-01
393  393   13.16443 0.8790589  33.54203 2.320338e-02
394  394   13.77427 0.8756240  27.89060 2.041857e-01
395  395   13.80367 0.8747736  29.30760 2.140649e-01
396  396   13.37659 0.8886166  30.26730 1.238739e-01
397  397   14.03913 0.8830209  27.41527 1.191693e-01
398  398   13.72403 0.8804484  30.64911 1.813854e-01
399  399   13.74549 0.8877526  27.53284 1.823754e-01
400  400   13.41123 0.8771425  30.41584 1.516200e-01
401  401   12.76539 0.8924969  35.08516 1.234364e-02
402  402   14.03440 0.8699039  29.76211 1.414835e-01
403  403   14.60739 0.8762886  23.62819 2.145740e-01
404  404   12.37232 0.8983987  33.41557 1.299872e-01
405  405   13.87531 0.8811464  28.46453 4.963830e-02
406  406   12.73798 0.8836392  32.76118 1.214716e-01
407  407   14.00286 0.8740258  28.24533 1.468536e-01
408  408   14.76436 0.8685881  28.12687 1.007404e-01
409  409   13.01724 0.8837623  32.71246 5.423817e-02
410  410   14.11751 0.8807844  29.22803 1.447201e-01
411  411   14.03999 0.8697167  31.48866 6.438368e-02
412  412   13.35228 0.8806187  31.02517 1.127864e-01
413  413   13.63274 0.8639669  33.19247 8.902563e-02
414  414   14.29327 0.8620309  29.64200 1.721620e-01
415  415   13.29284 0.8758810  32.34049 6.321683e-02
416  416   14.20755 0.8691610  31.01261 2.257565e-01
417  417   11.94758 0.8842774  36.95485 3.495120e-02
418  418   14.09180 0.8684994  32.75217 4.433411e-02
419  419   12.02846 0.9011269  36.23634 7.795669e-06
420  420   12.14529 0.8831459  36.32615 1.681381e-02
421  421   13.84320 0.8747835  29.94753 1.917727e-01
422  422   14.75618 0.8549506  28.47149 1.378262e-01
423  423   14.36477 0.8843470  25.15991 2.200929e-01
424  424   14.79443 0.8781854  24.63506 3.159128e-01
425  425   11.85116 0.9011939  33.73207 8.121300e-02
426  426   12.77617 0.9016119  29.91484 1.687545e-01
427  427   13.50781 0.8748181  30.66266 1.836372e-01
428  428   13.98899 0.8680966  28.64790 1.560940e-01
429  429   12.56756 0.8886319  33.48922 9.504939e-02
430  430   12.74288 0.8907100  32.03496 1.169337e-01
431  431   14.59335 0.8690242  31.21743 5.998571e-02
432  432   14.61667 0.8643157  27.51359 1.174472e-01
433  433   13.37669 0.8790412  31.56498 2.150755e-01
434  434   13.39622 0.8944817  29.41792 7.347124e-02
435  435   13.14279 0.9007402  29.37850 2.220686e-01
436  436   14.36658 0.8782917  25.53718 1.671296e-01
437  437   14.16958 0.8790275  26.96425 1.367528e-01
438  438   14.46517 0.8789319  27.78828 1.487434e-01
439  439   13.25401 0.8629005  34.31300 7.636595e-02
440  440   13.48027 0.8905068  30.31314 1.757704e-01
441  441   12.87780 0.8817626  33.08920 8.743709e-02
442  442   12.99252 0.8802673  35.01910 6.117458e-03
443  443   12.40084 0.8890051  34.26713 8.416232e-02
444  444   13.17345 0.8931483  29.69252 8.574566e-02
445  445   14.50878 0.8689099  28.98074 1.133932e-01
446  446   12.98305 0.8845816  31.39014 1.546303e-01
447  447   14.57449 0.8580736  27.54737 2.767286e-01
448  448   13.93197 0.8733238  29.24650 7.585604e-02
449  449   13.54384 0.8909176  30.63887 1.261145e-01
450  450   14.72633 0.8589222  27.99768 2.299772e-01
451  451   13.11754 0.8712106  32.63457 1.194875e-01
452  452   12.93450 0.8926541  31.74099 2.437091e-02
453  453   14.43282 0.8736274  29.88939 1.015021e-01
454  454   13.63916 0.8819468  28.34613 1.296564e-01
455  455   13.80342 0.8824280  30.68422 9.366623e-02
456  456   13.38664 0.8875889  30.06292 1.131218e-01
457  457   14.78769 0.8667768  27.54905 1.835664e-01
458  458   14.14563 0.8823771  28.28559 9.502792e-02
459  459   12.09453 0.9036734  33.41690 3.838985e-02
460  460   13.89895 0.8894225  27.38638 2.388863e-01
461  461   11.51723 0.8992534  35.42770 2.689718e-02
462  462   15.40962 0.8529876  27.58451 1.643079e-01
463  463   14.29540 0.8752046  28.38454 2.560348e-01
464  464   13.68304 0.8857996  31.42576 1.455034e-01
465  465   12.57727 0.9002470  30.05927 9.572758e-02
466  466   14.04401 0.8711774  29.28195 1.378219e-01
467  467   12.88696 0.8896603  30.94606 1.033580e-01
468  468   14.27296 0.8770564  26.47146 2.616757e-01
469  469   13.93147 0.8794865  27.93714 1.801645e-01
470  470   14.23878 0.8793427  26.23913 1.655958e-01
471  471   13.65766 0.8815757  30.56612 7.983791e-02
472  472   13.78371 0.8491724  34.33413 1.485917e-01
473  473   13.36795 0.8890170  31.83820 6.069603e-02
474  474   14.37019 0.8821970  29.34668 6.276024e-02
475  475   13.84585 0.8802558  30.43456 9.183615e-02
476  476   13.81012 0.8693529  30.81545 1.872985e-01
477  477   13.87125 0.8847903  28.55485 8.898467e-02
478  478   13.70660 0.8667396  35.23053 5.685678e-02
479  479   13.50401 0.8859227  30.65297 1.071025e-01
480  480   13.76357 0.8796300  29.46107 1.145240e-01
481  481   12.72261 0.8913804  33.73788 4.850099e-02
482  482   13.99767 0.8724922  29.78976 1.984211e-01
483  483   13.76629 0.8739953  32.84805 6.765990e-02
484  484   14.07995 0.8782044  29.59108 1.145723e-01
485  485   13.37167 0.8846705  31.25707 1.709013e-01
486  486   14.59692 0.8665513  31.54152 1.277693e-01
487  487   14.74282 0.8562689  27.33733 1.736801e-01
488  488   14.56720 0.8496493  30.33734 1.186189e-01
489  489   14.43673 0.8766034  26.12542 8.805679e-02
490  490   12.57256 0.8719717  35.95630 6.668547e-02
491  491   13.50984 0.8631819  33.32507 9.989852e-02
492  492   14.56742 0.8789474  27.25013 2.658629e-01
493  493   13.95829 0.8772761  29.53839 5.082255e-02
494  494   14.39003 0.8735146  27.46524 1.346567e-01
495  495   12.77886 0.8800569  34.73445 2.453329e-04
496  496   13.18455 0.8712941  32.12363 1.475936e-01
497  497   14.25439 0.8698674  27.83248 2.257074e-01
498  498   13.73148 0.8879259  29.16438 7.696560e-02
499  499   13.27282 0.8499659  34.96033 1.738773e-01
500  500   13.86734 0.8781539  28.74396 1.037946e-01</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables" class="level1">
<h1>16.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>var_imp_xgb <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(var_imp_xgb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Feature       Gain      Cover  Frequency
                    &lt;char&gt;      &lt;num&gt;      &lt;num&gt;      &lt;num&gt;
1:                      HH 0.14286427 0.09694303 0.09133858
2:                     C.O 0.13100318 0.14128737 0.13228346
3:                   MCARI 0.10928633 0.09616186 0.08503937
4:               LS_Factor 0.10089592 0.10051036 0.09763780
5:                    NDTI 0.08830066 0.12649724 0.11338583
6: Relative_Slope_Position 0.08338710 0.06460265 0.07874016</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables-1" class="level1">
<h1>17.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>var_imp_xgb_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables  =</span> var_imp_xgb<span class="sc">$</span>Feature,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> var_imp_xgb<span class="sc">$</span>Gain</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>var_imp_xgb_df <span class="ot">&lt;-</span> var_imp_xgb_df[<span class="fu">order</span>(<span class="sc">-</span>var_imp_xgb_df<span class="sc">$</span>importance), ]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_imp_xgb_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   variables importance
1                         HH 0.14286427
2                        C.O 0.13100318
3                      MCARI 0.10928633
4                  LS_Factor 0.10089592
5                       NDTI 0.08830066
6    Relative_Slope_Position 0.08338710
7               Valley_Depth 0.07689976
8                    Suelos_ 0.07098460
9                         CI 0.06814324
10                        HV 0.06473906
11 Topographic_Wetness_Index 0.06349586</code></pre>
</div>
</div>
</section>
<section id="se-grafican-para-entender-cúal-está-influyendo-más-en-el-modelo" class="level1">
<h1>18.Se grafican para entender cúal está influyendo más en el modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>XGBOOTS_Inf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(var_imp_xgb_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(importance),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variables, importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Importancia"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Importancia de variables – XGBoost (Lim_inf)"</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(XGBOOTS_Inf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-grafica-importancia_variables" class="level1">
<h1>19. Guardar grafica Importancia_variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Importancia_variables_XGB_Inf.png"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> XGBOOTS_Inf,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">14</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"cm"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="predicción-y-visualización" class="level1">
<h1>Predicción y visualización</h1>
</section>
<section id="nombres-de-capas-variables-del-modelo" class="level1">
<h1>20. Nombres de capas = variables del modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dataVARS <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"CI"</span>,<span class="st">"C.O"</span>, <span class="st">"MCARI"</span>, <span class="st">"LS_Factor"</span>, <span class="st">"NDTI"</span>, <span class="st">"HV"</span>,<span class="st">"HH"</span>,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"Relative_Slope_Position"</span>, <span class="st">"Suelos_"</span>, <span class="st">"Topographic_Wetness_Index"</span> ,<span class="st">"Valley_Depth"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En terra usamos 'subset' para quedarnos solo con las capas que necesitamos</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Asumiendo que tu objeto raster se llama 'raster' (o cámbiale el nombre)</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>r_predictores <span class="ot">&lt;-</span> <span class="fu">subset</span>(raster, dataVARS)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación de seguridad (Debe salir T</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"¿Están todas las variables?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "¿Están todas las variables?"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">all</span>(dataVARS <span class="sc">%in%</span> <span class="fu">names</span>(r_predictores)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="aplicar-modelo" class="level1">
<h1>21. Aplicar modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>Limite_Inf_XGB <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  r_predictores,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cf">function</span>(model, d, ...) {</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(model, <span class="fu">as.matrix</span>(d))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  Limite_Inf_XGB,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Inferior (XGBoost)"</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-modelo-rf_grid" class="level1">
<h1>22. Guardar modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(Limite_Inf_XGB, <span class="st">"D:/Mapa final/Limite_Inferior_XGB.tif"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
</div>
</section>
<section id="guardar-imagen-png-modelo-rf_grid" class="level1">
<h1>23. Guardar imagen png modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Inferior_XGB.png"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  Limite_Inf_XGB,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Inferior del departamento de Meta y Vichada (XGB)"</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="recorte-de-un-area-especifica" class="level1">
<h1>24. Recorte de un area especifica</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Raster de predicción</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Limite_Inf_XGB   <span class="co"># o rast("Limite_Inferior_XGB.tif")</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Polígono de la zona de interés</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/shp tesis/Altillanura_2.shp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="reproyectar" class="level1">
<h1>25. Reproyectar</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">project</span>(zona, <span class="fu">crs</span>(r))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="cortar-area-de-estudio" class="level1">
<h1>26. Cortar area de estudio</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(r, zona)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">mask</span>(r_crop, zona)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="mapa" class="level1">
<h1>27. Mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r_crop, <span class="at">main =</span> <span class="st">"Predicion Limite Inferior (XGB)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Inf_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-mapa" class="level1">
<h1>28. Guardar mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/Mapa final/Lim_inf_XGB_Altillanura.tif"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="guardar-mapa-como-imagen" class="level1">
<h1>29. Guardar mapa como imagen</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Inferior_Altillanura_XGB.png"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicion Limite Inferior (XGB)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
